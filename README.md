# è˜‘è‡ç§ç±»æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunmasj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://github.com/qunshansj/good)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

è˜‘è‡ä½œä¸ºä¸€ç§é‡è¦çš„é£Ÿç”¨å’Œè¯ç”¨èŒç±»ï¼Œå› å…¶ä¸°å¯Œçš„è¥å…»ä»·å€¼å’Œç‹¬ç‰¹çš„é£å‘³è€Œå—åˆ°å¹¿æ³›å…³æ³¨ã€‚ç„¶è€Œï¼Œè˜‘è‡çš„ç§ç±»ç¹å¤šï¼Œå½¢æ€å„å¼‚ï¼Œä¸”è®¸å¤šç§ç±»åœ¨å¤–è§‚ä¸Šæä¸ºç›¸ä¼¼ï¼Œè¿™ç»™è˜‘è‡çš„è¯†åˆ«å’Œåˆ†ç±»å¸¦æ¥äº†æå¤§çš„æŒ‘æˆ˜ã€‚ä¼ ç»Ÿçš„è˜‘è‡åˆ†ç±»æ–¹æ³•ä¸»è¦ä¾èµ–äºä¸“å®¶çš„ç»éªŒå’Œäººå·¥è§‚å¯Ÿï¼Œæ•ˆç‡ä½ä¸‹ä¸”å®¹æ˜“å—åˆ°ä¸»è§‚å› ç´ çš„å½±å“ã€‚å› æ­¤ï¼Œå¼€å‘ä¸€ç§é«˜æ•ˆã€å‡†ç¡®çš„è˜‘è‡ç§ç±»è¯†åˆ«ç³»ç»Ÿæ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚

è¿‘å¹´æ¥ï¼Œæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„è¿…çŒ›å‘å±•ä¸ºå›¾åƒè¯†åˆ«é¢†åŸŸå¸¦æ¥äº†é©å‘½æ€§çš„å˜åŒ–ï¼Œå°¤å…¶æ˜¯åœ¨ç‰©ä½“æ£€æµ‹æ–¹é¢ã€‚YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡å‹å› å…¶å®æ—¶æ€§å’Œé«˜å‡†ç¡®ç‡è€Œå¹¿æ³›åº”ç”¨äºå„ç§è§†è§‰è¯†åˆ«ä»»åŠ¡ã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥æå‡äº†æ¨¡å‹çš„æ€§èƒ½å’Œæ•ˆç‡ï¼Œå…·å¤‡äº†æ›´å¼ºçš„ç‰¹å¾æå–èƒ½åŠ›å’Œæ›´å¿«çš„æ¨ç†é€Ÿåº¦ã€‚åŸºäºYOLOv8çš„è˜‘è‡ç§ç±»è¯†åˆ«ç³»ç»Ÿçš„æ„å»ºï¼Œä¸ä»…èƒ½å¤Ÿæé«˜è˜‘è‡åˆ†ç±»çš„å‡†ç¡®æ€§ï¼Œè¿˜èƒ½åœ¨å®é™…åº”ç”¨ä¸­å®ç°å®æ—¶æ£€æµ‹ï¼Œä¸ºè˜‘è‡çš„å®‰å…¨é£Ÿç”¨å’Œç§‘å­¦ç ”ç©¶æä¾›é‡è¦æ”¯æŒã€‚

æœ¬ç ”ç©¶æ‰€ä½¿ç”¨çš„æ•°æ®é›†åŒ…å«3019å¼ å›¾åƒï¼Œæ¶µç›–äº†13ä¸ªè˜‘è‡ç§ç±»ï¼ŒåŒ…æ‹¬å¸¸è§çš„é£Ÿç”¨è˜‘è‡å’Œä¸€äº›å…·æœ‰æ¯’æ€§çš„å“ç§ã€‚æ•°æ®é›†çš„å¤šæ ·æ€§å’Œä¸°å¯Œæ€§ä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›äº†è‰¯å¥½çš„åŸºç¡€ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿå­¦ä¹ åˆ°ä¸åŒç§ç±»è˜‘è‡çš„ç‰¹å¾ã€‚è¿™äº›ç§ç±»çš„è˜‘è‡åœ¨ç”Ÿæ€ç³»ç»Ÿä¸­æ‰®æ¼”ç€é‡è¦è§’è‰²ï¼Œäº†è§£å®ƒä»¬çš„åˆ†ç±»å’Œç‰¹å¾ä¸ä»…æœ‰åŠ©äºæé«˜äººä»¬å¯¹è˜‘è‡çš„è®¤è¯†ï¼Œè¿˜èƒ½ä¿ƒè¿›ç”Ÿç‰©å¤šæ ·æ€§çš„ä¿æŠ¤å’Œå¯æŒç»­åˆ©ç”¨ã€‚

é€šè¿‡æ”¹è¿›YOLOv8æ¨¡å‹ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåœ¨è˜‘è‡ç§ç±»è¯†åˆ«ä¸­å®ç°æ›´é«˜çš„å‡†ç¡®ç‡å’Œæ›´å¿«çš„å¤„ç†é€Ÿåº¦ã€‚è¿™ä¸€ç ”ç©¶ä¸ä»…å…·æœ‰é‡è¦çš„ç†è®ºæ„ä¹‰ï¼Œè¿˜å…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚é¦–å…ˆï¼Œåœ¨é£Ÿå“å®‰å…¨é¢†åŸŸï¼Œå‡†ç¡®è¯†åˆ«é£Ÿç”¨è˜‘è‡å’Œæœ‰æ¯’è˜‘è‡èƒ½å¤Ÿæœ‰æ•ˆå‡å°‘è¯¯é£Ÿäº‹ä»¶çš„å‘ç”Ÿï¼Œä¿éšœå…¬ä¼—çš„å¥åº·å®‰å…¨ã€‚å…¶æ¬¡ï¼Œåœ¨ç”Ÿæ€ç ”ç©¶ä¸­ï¼Œå¿«é€Ÿå‡†ç¡®çš„è˜‘è‡ç§ç±»è¯†åˆ«èƒ½å¤Ÿä¸ºç”Ÿæ€ç›‘æµ‹å’Œç”Ÿç‰©å¤šæ ·æ€§ç ”ç©¶æä¾›é‡è¦çš„æ•°æ®æ”¯æŒï¼Œä¿ƒè¿›å¯¹ç”Ÿæ€ç³»ç»Ÿçš„æ·±å…¥ç†è§£ã€‚æ­¤å¤–ï¼Œè¯¥ç³»ç»Ÿè¿˜å¯ä»¥åº”ç”¨äºå†œä¸šç”Ÿäº§ï¼Œå¸®åŠ©å†œæ°‘è¯†åˆ«å’Œç®¡ç†è˜‘è‡ç§æ¤ï¼Œæé«˜ç”Ÿäº§æ•ˆç‡ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„è˜‘è‡ç§ç±»è¯†åˆ«ç³»ç»Ÿçš„ç ”ç©¶ï¼Œä¸ä»…èƒ½å¤Ÿæ¨åŠ¨è®¡ç®—æœºè§†è§‰æŠ€æœ¯åœ¨ç”Ÿç‰©åˆ†ç±»ä¸­çš„åº”ç”¨ï¼Œè¿˜èƒ½ä¸ºé£Ÿå“å®‰å…¨ã€ç”Ÿæ€ä¿æŠ¤å’Œå†œä¸šå‘å±•æä¾›åˆ‡å®çš„è§£å†³æ–¹æ¡ˆï¼Œå…·æœ‰é‡è¦çš„å­¦æœ¯ä»·å€¼å’Œç¤¾ä¼šæ„ä¹‰ã€‚é€šè¿‡æœ¬ç ”ç©¶ï¼Œæˆ‘ä»¬æœŸæœ›èƒ½å¤Ÿä¸ºè˜‘è‡ç§ç±»çš„å¿«é€Ÿè¯†åˆ«å’Œåˆ†ç±»æä¾›ä¸€ç§æ–°æ€è·¯ï¼Œæ¨åŠ¨ç›¸å…³é¢†åŸŸçš„è¿›ä¸€æ­¥å‘å±•ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV12opYepE4Y/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 12
names: ['-', 'Agaricus campestris', 'Agrocybe pediades', 'Amanita muscaria', 'Amanita velosa', 'Bovista plumbea', 'Cryptoporus volvatus', 'Gymnopus dryophilus', 'Omphalotus olivascens', 'Pholiota aurivella', 'Podaxis pistillaris', 'Volvopluteus gloiocephalus']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨æœ¬ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†åä¸ºâ€œProcesamientoâ€çš„æ•°æ®é›†ï¼Œä»¥è®­ç»ƒå’Œæ”¹è¿›YOLOv8æ¨¡å‹ï¼Œæ—¨åœ¨å®ç°å¯¹ä¸åŒè˜‘è‡ç§ç±»çš„å‡†ç¡®è¯†åˆ«å’Œåˆ†ç±»ã€‚è¯¥æ•°æ®é›†çš„è®¾è®¡å……åˆ†è€ƒè™‘äº†è˜‘è‡ç§ç±»çš„å¤šæ ·æ€§ä¸å¤æ‚æ€§ï¼ŒåŒ…å«äº†12ä¸ªä¸åŒçš„ç±»åˆ«ï¼Œæ¯ä¸ªç±»åˆ«ä»£è¡¨ä¸€ç§ç‰¹å®šçš„è˜‘è‡ã€‚æ•°æ®é›†çš„ç±»åˆ«åˆ—è¡¨åŒ…æ‹¬ï¼šAgaricus campestrisã€Agrocybe pediadesã€Amanita muscariaã€Amanita velosaã€Bovista plumbeaã€Cryptoporus volvatusã€Gymnopus dryophilusã€Omphalotus olivascensã€Pholiota aurivellaã€Podaxis pistillarisä»¥åŠVolvopluteus gloiocephalusã€‚è¿™äº›è˜‘è‡ç§ç±»åœ¨ç”Ÿæ€ç³»ç»Ÿä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ï¼Œæ—¢æœ‰é£Ÿç”¨ä»·å€¼ï¼Œä¹Ÿæœ‰å¯èƒ½å¯¹äººç±»å¥åº·æ„æˆå¨èƒï¼Œå› æ­¤å‡†ç¡®è¯†åˆ«å®ƒä»¬å…·æœ‰é‡è¦çš„å®é™…æ„ä¹‰ã€‚

â€œProcesamientoâ€æ•°æ®é›†çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œç ”ç©¶å›¢é˜Ÿæ³¨é‡æ•°æ®çš„å¤šæ ·æ€§å’Œä»£è¡¨æ€§ï¼Œç¡®ä¿æ¯ä¸ªç±»åˆ«éƒ½åŒ…å«äº†ä¸°å¯Œçš„æ ·æœ¬ã€‚è¿™äº›æ ·æœ¬ä¸ä»…æ¶µç›–äº†ä¸åŒç”Ÿé•¿ç¯å¢ƒä¸‹çš„è˜‘è‡ï¼Œè¿˜è€ƒè™‘äº†ä¸åŒç”Ÿé•¿é˜¶æ®µã€ä¸åŒå…‰ç…§æ¡ä»¶ä»¥åŠä¸åŒæ‹æ‘„è§’åº¦ç­‰å› ç´ ã€‚è¿™ç§å¤šæ ·æ€§ä½¿å¾—æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿå­¦ä¹ åˆ°æ›´ä¸ºå…¨é¢çš„ç‰¹å¾ï¼Œä»è€Œæé«˜å…¶åœ¨å®é™…åº”ç”¨ä¸­çš„æ³›åŒ–èƒ½åŠ›ã€‚

åœ¨æ•°æ®é›†çš„æ ‡æ³¨è¿‡ç¨‹ä¸­ï¼Œé‡‡ç”¨äº†é«˜æ ‡å‡†çš„æ ‡æ³¨è§„èŒƒï¼Œç¡®ä¿æ¯ä¸ªæ ·æœ¬çš„ç±»åˆ«æ ‡æ³¨å‡†ç¡®æ— è¯¯ã€‚æ¯ä¸ªè˜‘è‡æ ·æœ¬éƒ½ç»è¿‡ä¸“ä¸šçš„ç”Ÿç‰©å­¦å®¶è¿›è¡Œç¡®è®¤ï¼Œä»¥ç¡®ä¿æ•°æ®çš„çœŸå®æ€§å’Œå¯é æ€§ã€‚è¿™ä¸€è¿‡ç¨‹ä¸ä»…æé«˜äº†æ•°æ®é›†çš„è´¨é‡ï¼Œä¹Ÿä¸ºåç»­çš„æ¨¡å‹è®­ç»ƒæä¾›äº†åšå®çš„åŸºç¡€ã€‚

é€šè¿‡å¯¹â€œProcesamientoâ€æ•°æ®é›†çš„æ·±å…¥åˆ†æï¼Œæˆ‘ä»¬å‘ç°ä¸åŒè˜‘è‡ç§ç±»åœ¨å½¢æ€ç‰¹å¾ä¸Šå­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ä¾‹å¦‚ï¼ŒAmanita muscariaä»¥å…¶é²œè‰³çš„çº¢è‰²å’Œç™½è‰²æ–‘ç‚¹è€Œé—»åï¼Œè€ŒAgaricus campestrisåˆ™å‘ˆç°å‡ºè¾ƒä¸ºæœ´ç´ çš„å¤–è§‚ã€‚è¿™äº›å½¢æ€ç‰¹å¾çš„å·®å¼‚ä¸ºYOLOv8æ¨¡å‹çš„è®­ç»ƒæä¾›äº†ä¸°å¯Œçš„ç‰¹å¾å­¦ä¹ ç©ºé—´ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨è¯†åˆ«è¿‡ç¨‹ä¸­æ›´å¥½åœ°æ•æ‰åˆ°è¿™äº›ç»†å¾®çš„å·®åˆ«ã€‚

æ­¤å¤–ï¼Œæ•°æ®é›†è¿˜åŒ…å«äº†å¤§é‡çš„èƒŒæ™¯ä¿¡æ¯å’Œç¯å¢ƒæ•°æ®ï¼Œè¿™ä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›äº†æ›´å¤šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼ŒæŸäº›è˜‘è‡ç§ç±»æ›´å€¾å‘äºåœ¨ç‰¹å®šçš„åœŸå£¤ç±»å‹æˆ–æ°”å€™æ¡ä»¶ä¸‹ç”Ÿé•¿ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥å¸®åŠ©æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­è¿›è¡Œæ›´ä¸ºå‡†ç¡®çš„åˆ¤æ–­ã€‚é€šè¿‡å°†è¿™äº›ç¯å¢ƒå› ç´ ä¸è˜‘è‡çš„å¤–è§‚ç‰¹å¾ç»“åˆï¼ŒYOLOv8æ¨¡å‹èƒ½å¤Ÿåœ¨å¤æ‚çš„ç¯å¢ƒä¸­å®ç°æ›´é«˜çš„è¯†åˆ«å‡†ç¡®ç‡ã€‚

æ€»ä¹‹ï¼Œâ€œProcesamientoâ€æ•°æ®é›†ä¸ºæˆ‘ä»¬æ”¹è¿›YOLOv8æ¨¡å‹æä¾›äº†ä¸€ä¸ªæä¸ºä¸°å¯Œå’Œå¤šæ ·åŒ–çš„è®­ç»ƒåŸºç¡€ã€‚é€šè¿‡å¯¹ä¸åŒè˜‘è‡ç§ç±»çš„æ·±å…¥å­¦ä¹ å’Œåˆ†æï¼Œæˆ‘ä»¬æœŸæœ›èƒ½å¤Ÿæå‡æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­çš„è¡¨ç°ï¼Œæœ€ç»ˆå®ç°å¯¹è˜‘è‡ç§ç±»çš„é«˜æ•ˆã€å‡†ç¡®è¯†åˆ«ã€‚è¿™ä¸ä»…æœ‰åŠ©äºæ¨åŠ¨è˜‘è‡åˆ†ç±»æŠ€æœ¯çš„å‘å±•ï¼Œä¹Ÿä¸ºç›¸å…³é¢†åŸŸçš„ç ”ç©¶æä¾›äº†æ–°çš„æ€è·¯å’Œæ–¹å‘ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOv8ä½œä¸ºYOLOç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œä»£è¡¨äº†ç›®æ ‡æ£€æµ‹é¢†åŸŸä¸­çš„ä¸€é¡¹é‡è¦è¿›å±•ã€‚å…¶è®¾è®¡ç†å¿µä¸ä»…å»¶ç»­äº†YOLOç³»åˆ—çš„é«˜æ•ˆæ€§å’Œå®æ—¶æ€§ï¼Œè¿˜åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œäº†å¤šé¡¹åˆ›æ–°å’Œæ”¹è¿›ï¼Œä½¿å¾—æ¨¡å‹åœ¨æ€§èƒ½å’Œçµæ´»æ€§ä¸Šæœ‰äº†æ˜¾è‘—æå‡ã€‚YOLOv8sæ¨¡å‹çš„æ¶æ„ä¸»è¦ç”±ä¸‰ä¸ªæ ¸å¿ƒéƒ¨åˆ†ç»„æˆï¼šBackboneã€Neckå’ŒHeadï¼Œæ¯ä¸ªéƒ¨åˆ†åœ¨æ•´ä½“åŠŸèƒ½ä¸­æ‰®æ¼”ç€ä¸å¯æˆ–ç¼ºçš„è§’è‰²ã€‚

åœ¨Backboneéƒ¨åˆ†ï¼ŒYOLOv8sé‡‡ç”¨äº†CSPDarknetï¼ˆCross Stage Partial Darknetï¼‰ç»“æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªç»è¿‡ä¼˜åŒ–çš„ç‰¹å¾æå–ç½‘ç»œã€‚CSPDarknetçš„è®¾è®¡å°†ç½‘ç»œåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½åŒ…å«å¤šä¸ªæ®‹å·®å—ï¼Œè¿™ç§ç»“æ„çš„å¼•å…¥æœ‰æ•ˆåœ°æé«˜äº†ç‰¹å¾æå–çš„æ•ˆç‡ã€‚ä¸å‰ä»£æ¨¡å‹YOLOv5ç›¸æ¯”ï¼ŒYOLOv8sç”¨C2fæ¨¡å—æ›¿ä»£äº†C3æ¨¡å—ã€‚C2fæ¨¡å—çš„åˆ›æ–°åœ¨äºå®ƒå°†è¾“å…¥çš„ç‰¹å¾å›¾åˆ†æˆä¸¤ä¸ªåˆ†æ”¯ï¼Œåˆ†åˆ«ç»è¿‡å·ç§¯å±‚è¿›è¡Œé™ç»´å¤„ç†ï¼Œè¿™ç§åˆ†æ”¯ç»“æ„ä¸ä»…å¢åŠ äº†ç½‘ç»œçš„çµæ´»æ€§ï¼Œè¿˜ä½¿å¾—ç‰¹å¾å›¾çš„ç»´åº¦å¾—ä»¥æå‡ã€‚æ­¤å¤–ï¼ŒC2fæ¨¡å—ä¸­å¼•å…¥çš„v8_C2fBottleneckå±‚ä¹Ÿæå¤§åœ°å¢å¼ºäº†ç‰¹å¾çš„è¡¨è¾¾èƒ½åŠ›ï¼Œè¾“å‡ºçš„ç‰¹å¾å›¾ç»è¿‡è¿›ä¸€æ­¥çš„å·ç§¯èåˆï¼Œå½¢æˆäº†æ›´é«˜ç»´åº¦çš„ç‰¹å¾å›¾ï¼Œä»è€Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ•æ‰åˆ°æ›´ä¸°å¯Œçš„æ¢¯åº¦æµä¿¡æ¯ã€‚

åœ¨ç‰¹å¾æå–çš„è¿‡ç¨‹ä¸­ï¼ŒYOLOv8sè¿˜å¼•å…¥äº†å¿«é€Ÿç©ºé—´é‡‘å­—å¡”æ± åŒ–ï¼ˆSPPFï¼‰ç»“æ„ã€‚SPPFçš„è®¾è®¡æ—¨åœ¨æå–ä¸åŒå°ºåº¦çš„ç‰¹å¾ï¼Œè¿™ä¸€ç»“æ„çš„ä¼˜åŠ¿åœ¨äºèƒ½å¤Ÿæœ‰æ•ˆå‡å°‘æ¨¡å‹çš„å‚æ•°é‡å’Œè®¡ç®—é‡ï¼ŒåŒæ—¶æå‡ç‰¹å¾æå–çš„æ•ˆç‡ã€‚é€šè¿‡è¿™ç§å¤šå°ºåº¦ç‰¹å¾æå–æ–¹å¼ï¼ŒYOLOv8sèƒ½å¤Ÿæ›´å¥½åœ°åº”å¯¹å„ç§ç›®æ ‡çš„æ£€æµ‹ä»»åŠ¡ï¼Œæ— è®ºæ˜¯å°ç›®æ ‡è¿˜æ˜¯å¤§ç›®æ ‡ï¼Œæ¨¡å‹éƒ½èƒ½ä¿æŒè¾ƒé«˜çš„æ£€æµ‹å‡†ç¡®åº¦ã€‚

æ¥ä¸‹æ¥æ˜¯Neckéƒ¨åˆ†ï¼Œå®ƒé‡‡ç”¨äº†ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œï¼ˆFPNï¼‰ä¸è·¯å¾„èšåˆç½‘ç»œï¼ˆPANï¼‰çš„ç»“åˆã€‚è¿™ä¸€ç»“æ„çš„è®¾è®¡ç›®çš„æ˜¯å°†æ¥è‡ªBackboneä¸åŒé˜¶æ®µçš„ç‰¹å¾å›¾è¿›è¡Œèåˆï¼Œä»¥ä¾¿æ›´å¥½åœ°æ•æ‰ä¸åŒå°ºåº¦ç›®æ ‡çš„ä¿¡æ¯ã€‚é€šè¿‡å¤šå±‚æ¬¡çš„ç‰¹å¾èåˆï¼ŒYOLOv8såœ¨å¤„ç†å¤æ‚åœºæ™¯æ—¶è¡¨ç°å‡ºæ›´å¼ºçš„é²æ£’æ€§å’Œå‡†ç¡®æ€§ã€‚Neckéƒ¨åˆ†çš„å·ç§¯å±‚å’Œæ± åŒ–å±‚ä¸ä»…æœ‰æ•ˆåœ°å‹ç¼©äº†ç‰¹å¾å›¾ï¼Œè¿˜å¢å¼ºäº†æ¨¡å‹å¯¹ç›®æ ‡çš„æ£€æµ‹èƒ½åŠ›ã€‚

æœ€åæ˜¯Headéƒ¨åˆ†ï¼Œè´Ÿè´£æœ€ç»ˆçš„ç›®æ ‡æ£€æµ‹å’Œåˆ†ç±»ä»»åŠ¡ã€‚YOLOv8sçš„Headè®¾è®¡åŒ…å«ä¸‰ä¸ªæ£€æµ‹å¤´ï¼Œåˆ†åˆ«ç”¨äºå¤„ç†ä¸åŒå°ºå¯¸çš„ç›®æ ‡ä¿¡æ¯ã€‚æ¯ä¸ªæ£€æµ‹å¤´å†…éƒ¨ç”±ä¸€ç³»åˆ—å·ç§¯å±‚å’Œåå·ç§¯å±‚æ„æˆï¼Œè´Ÿè´£å°†ç»è¿‡Neckå¤„ç†åçš„ç‰¹å¾å›¾è½¬æ¢ä¸ºæœ€ç»ˆçš„æ£€æµ‹ç»“æœã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒYOLOv8sé‡‡ç”¨äº†ä¸€ç§åŸºäºæ— é”šæ¡†ï¼ˆAnchor-Freeï¼‰çš„æ£€æµ‹æ–¹å¼ã€‚è¿™ç§æ–¹æ³•ç›´æ¥é¢„æµ‹ç›®æ ‡çš„ä¸­å¿ƒç‚¹å’Œå®½é«˜æ¯”ä¾‹ï¼Œé¿å…äº†ä¼ ç»ŸAnchoræ¡†çš„è®¾è®¡ï¼Œä½¿å¾—æ¨¡å‹åœ¨æ£€æµ‹é€Ÿåº¦å’Œå‡†ç¡®åº¦ä¸Šéƒ½å¾—åˆ°äº†æ˜¾è‘—æå‡ã€‚

åœ¨YOLOv8çš„è®¾è®¡ä¸­ï¼Œæ•´ä½“æ¶æ„çš„ä¼˜åŒ–å’Œå„ä¸ªæ¨¡å—çš„åˆ›æ–°ç›¸è¾…ç›¸æˆï¼Œä½¿å¾—è¯¥æ¨¡å‹åœ¨ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­å±•ç°å‡ºå¼ºå¤§çš„æ€§èƒ½ã€‚YOLOv8ä¸ä»…åœ¨å‡†ç¡®æ€§ä¸Šæœ‰äº†æ˜¾è‘—æé«˜ï¼Œå…¶å®æ—¶æ€§ä¹Ÿå¾—åˆ°äº†ä¿éšœï¼Œèƒ½å¤Ÿæ»¡è¶³å„ç§åº”ç”¨åœºæ™¯çš„éœ€æ±‚ã€‚é€šè¿‡å¯¹Backboneã€Neckå’ŒHeadçš„ç²¾å¿ƒè®¾è®¡ï¼ŒYOLOv8å®ç°äº†ç‰¹å¾æå–ä¸ç›®æ ‡æ£€æµ‹çš„é«˜æ•ˆç»“åˆï¼Œä¸ºç›®æ ‡æ£€æµ‹æŠ€æœ¯çš„å‘å±•æä¾›äº†æ–°çš„æ€è·¯å’Œæ–¹å‘ã€‚

æ€»çš„æ¥è¯´ï¼ŒYOLOv8sä½œä¸ºYOLOç³»åˆ—çš„æœ€æ–°ä»£è¡¨ï¼Œå‡­å€Ÿå…¶é«˜æ•ˆçš„ç‰¹å¾æå–å’Œç›®æ ‡æ£€æµ‹èƒ½åŠ›ï¼Œå·²ç»æˆä¸ºç›®æ ‡æ£€æµ‹é¢†åŸŸçš„é‡è¦å·¥å…·ã€‚å…¶å¼•å…¥çš„å¤šé¡¹åˆ›æ–°è®¾è®¡ï¼Œä½¿å¾—YOLOv8såœ¨å¤„ç†å¤æ‚åœºæ™¯å’Œå¤šå°ºåº¦ç›®æ ‡æ—¶ï¼Œå±•ç°å‡ºä¼˜è¶Šçš„æ€§èƒ½å’Œçµæ´»æ€§ã€‚éšç€YOLOv8çš„ä¸æ–­å‘å±•å’Œå®Œå–„ï¼Œæœªæ¥åœ¨æ™ºèƒ½ç›‘æ§ã€è‡ªåŠ¨é©¾é©¶ã€æ— äººæœºè§†è§‰ç­‰å¤šä¸ªé¢†åŸŸçš„åº”ç”¨å‰æ™¯å°†æ›´åŠ å¹¿é˜”ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 ui.py

ä»¥ä¸‹æ˜¯ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æ„å»ºè¿è¡Œå‘½ä»¤ï¼Œä½¿ç”¨ streamlit è¿è¡ŒæŒ‡å®šçš„è„šæœ¬
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆ
    result = subprocess.run(command, shell=True)
    
    # æ£€æŸ¥å‘½ä»¤æ‰§è¡Œçš„è¿”å›ç ï¼Œè‹¥ä¸ä¸º0åˆ™è¡¨ç¤ºå‡ºé”™
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")

# å®ä¾‹åŒ–å¹¶è¿è¡Œåº”ç”¨
if __name__ == "__main__":
    # æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # è¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨è„šæœ¬åï¼Œå‡è®¾å®ƒåœ¨å½“å‰ç›®å½•ä¸‹

    # è°ƒç”¨å‡½æ•°è¿è¡Œè„šæœ¬
    run_script(script_path)
```

### ä»£ç åˆ†æï¼š
1. **å¯¼å…¥æ¨¡å—**ï¼š
   - `sys`ï¼šç”¨äºè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - `subprocess`ï¼šç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

2. **`run_script` å‡½æ•°**ï¼š
   - è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„ Python è„šæœ¬çš„è·¯å¾„ã€‚
   - ä½¿ç”¨ `sys.executable` è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - æ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ `streamlit` è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚
   - ä½¿ç”¨ `subprocess.run` æ‰§è¡Œæ„å»ºçš„å‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆã€‚
   - æ£€æŸ¥å‘½ä»¤çš„è¿”å›ç ï¼Œå¦‚æœè¿”å›ç ä¸ä¸º0ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œå‡ºé”™ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯ã€‚

3. **ä¸»ç¨‹åºéƒ¨åˆ†**ï¼š
   - ä½¿ç”¨ `if __name__ == "__main__":` ç¡®ä¿è¯¥ä»£ç å—åªåœ¨ç›´æ¥è¿è¡Œè„šæœ¬æ—¶æ‰§è¡Œã€‚
   - æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼ˆåœ¨è¿™é‡Œæ˜¯ `web.py`ï¼‰ã€‚
   - è°ƒç”¨ `run_script` å‡½æ•°ï¼Œä¼ å…¥è„šæœ¬è·¯å¾„ä»¥æ‰§è¡Œè¯¥è„šæœ¬ã€‚ 

### æ€»ç»“ï¼š
è¯¥ä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯é€šè¿‡å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„ `streamlit` è„šæœ¬ï¼Œå¹¶å¤„ç†å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `ui.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒæ¥è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ¥è¯´æ˜¯ä¸€ä¸ªåä¸º `web.py` çš„è„šæœ¬ã€‚ç¨‹åºé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ï¼Œè¿™äº›æ¨¡å—åˆ†åˆ«ç”¨äºè·å–ç³»ç»Ÿä¿¡æ¯ã€æ“ä½œç³»ç»ŸåŠŸèƒ½å’Œæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

åœ¨ `run_script` å‡½æ•°ä¸­ï¼Œé¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œè¿™é€šè¿‡ `sys.executable` å®ç°ã€‚æ¥ç€ï¼Œæ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œè¯¥å‘½ä»¤ç”¨äºè°ƒç”¨ `streamlit` æ¨¡å—å¹¶è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚`streamlit` æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºæ•°æ®åº”ç”¨çš„æ¡†æ¶ï¼Œå‘½ä»¤çš„æ ¼å¼æ˜¯å°† Python è§£é‡Šå™¨å’Œè„šæœ¬è·¯å¾„ç»„åˆåœ¨ä¸€èµ·ã€‚

ç„¶åï¼Œä½¿ç”¨ `subprocess.run` æ–¹æ³•æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ã€‚è¯¥æ–¹æ³•ä¼šåœ¨ä¸€ä¸ªæ–°çš„ shell ä¸­è¿è¡Œå‘½ä»¤ï¼Œå¹¶è¿”å›ä¸€ä¸ªç»“æœå¯¹è±¡ã€‚é€šè¿‡æ£€æŸ¥ `result.returncode`ï¼Œå¯ä»¥åˆ¤æ–­è„šæœ¬æ˜¯å¦æˆåŠŸè¿è¡Œã€‚å¦‚æœè¿”å›ç ä¸ä¸ºé›¶ï¼Œè¯´æ˜è„šæœ¬è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†é”™è¯¯ï¼Œæ­¤æ—¶ç¨‹åºä¼šè¾“å‡ºä¸€æ¡é”™è¯¯ä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œä½¿ç”¨ `if __name__ == "__main__":` è¯­å¥æ¥ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥æ–‡ä»¶æ—¶æ‰ä¼šæ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚è¿™éƒ¨åˆ†ä»£ç æŒ‡å®šäº†è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼Œè¿™é‡Œä½¿ç”¨äº† `abs_path` å‡½æ•°æ¥è·å– `web.py` çš„ç»å¯¹è·¯å¾„ã€‚æœ€åï¼Œè°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡Œè¿™ä¸ªè„šæœ¬ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä¸»è¦ä½œç”¨æ˜¯ä½œä¸ºä¸€ä¸ªå¯åŠ¨å™¨ï¼Œæ–¹ä¾¿ç”¨æˆ·é€šè¿‡ Python ç¯å¢ƒæ¥è¿è¡Œä¸€ä¸ª Streamlit åº”ç”¨ã€‚

#### 11.2 ultralytics\models\sam\predict.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class Predictor(BasePredictor):
    """
    Segment Anything Model (SAM) çš„é¢„æµ‹å™¨ç±»ï¼Œç»§æ‰¿è‡ª BasePredictorã€‚

    è¯¥ç±»æä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œç”¨äºé’ˆå¯¹å›¾åƒåˆ†å‰²ä»»åŠ¡è¿›è¡Œæ¨¡å‹æ¨ç†ã€‚
    å…·å¤‡å…ˆè¿›çš„æ¶æ„å’Œå¯æç¤ºçš„åˆ†å‰²èƒ½åŠ›ï¼Œæ”¯æŒçµæ´»çš„å®æ—¶æ©è†œç”Ÿæˆã€‚
    å¯ä»¥å¤„ç†å¤šç§ç±»å‹çš„æç¤ºï¼Œä¾‹å¦‚è¾¹ç•Œæ¡†ã€ç‚¹å’Œä½åˆ†è¾¨ç‡æ©è†œã€‚
    """

    def __init__(self, cfg=DEFAULT_CFG, overrides=None, _callbacks=None):
        """
        åˆå§‹åŒ–é¢„æµ‹å™¨ï¼Œè®¾ç½®é…ç½®ã€è¦†ç›–å’Œå›è°ƒã€‚

        Args:
            cfg (dict): é…ç½®å­—å…¸ã€‚
            overrides (dict, optional): è¦†ç›–é»˜è®¤é…ç½®çš„å€¼çš„å­—å…¸ã€‚
            _callbacks (dict, optional): è‡ªå®šä¹‰å›è°ƒå‡½æ•°çš„å­—å…¸ã€‚
        """
        if overrides is None:
            overrides = {}
        overrides.update(dict(task="segment", mode="predict", imgsz=1024))
        super().__init__(cfg, overrides, _callbacks)
        self.args.retina_masks = True  # å¯ç”¨è§†ç½‘è†œæ©è†œ
        self.im = None  # è¾“å…¥å›¾åƒ
        self.features = None  # æå–çš„å›¾åƒç‰¹å¾
        self.prompts = {}  # æç¤ºé›†åˆ
        self.segment_all = False  # æ˜¯å¦åˆ†å‰²æ‰€æœ‰å¯¹è±¡çš„æ ‡å¿—

    def preprocess(self, im):
        """
        å¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼Œä»¥ä¾¿è¿›è¡Œæ¨¡å‹æ¨ç†ã€‚

        Args:
            im (torch.Tensor | List[np.ndarray]): BCHWæ ¼å¼çš„å¼ é‡æˆ–HWCæ ¼å¼çš„numpyæ•°ç»„åˆ—è¡¨ã€‚

        Returns:
            (torch.Tensor): é¢„å¤„ç†åçš„å›¾åƒå¼ é‡ã€‚
        """
        if self.im is not None:
            return self.im  # å¦‚æœå·²ç»å¤„ç†è¿‡ï¼Œç›´æ¥è¿”å›
        not_tensor = not isinstance(im, torch.Tensor)
        if not_tensor:
            im = np.stack(self.pre_transform(im))  # é¢„è½¬æ¢
            im = im[..., ::-1].transpose((0, 3, 1, 2))  # é¢œè‰²é€šé“è½¬æ¢
            im = np.ascontiguousarray(im)
            im = torch.from_numpy(im)  # è½¬æ¢ä¸ºå¼ é‡

        im = im.to(self.device)  # ç§»åŠ¨åˆ°æŒ‡å®šè®¾å¤‡
        im = im.half() if self.model.fp16 else im.float()  # æ ¹æ®æ¨¡å‹è®¾ç½®è½¬æ¢æ•°æ®ç±»å‹
        if not_tensor:
            im = (im - self.mean) / self.std  # å½’ä¸€åŒ–
        return im

    def inference(self, im, bboxes=None, points=None, labels=None, masks=None, multimask_output=False, *args, **kwargs):
        """
        åŸºäºç»™å®šçš„è¾“å…¥æç¤ºæ‰§è¡Œå›¾åƒåˆ†å‰²æ¨ç†ã€‚

        Args:
            im (torch.Tensor): é¢„å¤„ç†åçš„è¾“å…¥å›¾åƒå¼ é‡ï¼Œå½¢çŠ¶ä¸º (N, C, H, W)ã€‚
            bboxes (np.ndarray | List, optional): è¾¹ç•Œæ¡†ï¼Œå½¢çŠ¶ä¸º (N, 4)ï¼ŒXYXYæ ¼å¼ã€‚
            points (np.ndarray | List, optional): æŒ‡ç¤ºå¯¹è±¡ä½ç½®çš„ç‚¹ï¼Œå½¢çŠ¶ä¸º (N, 2)ï¼Œåƒç´ åæ ‡ã€‚
            labels (np.ndarray | List, optional): ç‚¹æç¤ºçš„æ ‡ç­¾ï¼Œå½¢çŠ¶ä¸º (N, )ã€‚1è¡¨ç¤ºå‰æ™¯ï¼Œ0è¡¨ç¤ºèƒŒæ™¯ã€‚
            masks (np.ndarray, optional): å…ˆå‰é¢„æµ‹çš„ä½åˆ†è¾¨ç‡æ©è†œï¼Œå½¢çŠ¶åº”ä¸º (N, H, W)ï¼Œå¯¹äºSAMï¼ŒH=W=256ã€‚
            multimask_output (bool, optional): è¿”å›å¤šä¸ªæ©è†œçš„æ ‡å¿—ã€‚å¯¹æ¨¡ç³Šæç¤ºæœ‰å¸®åŠ©ã€‚é»˜è®¤ä¸ºFalseã€‚

        Returns:
            (tuple): åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªå…ƒç´ çš„å…ƒç»„ã€‚
                - np.ndarray: è¾“å‡ºæ©è†œï¼Œå½¢çŠ¶ä¸º CxHxWï¼Œå…¶ä¸­ C æ˜¯ç”Ÿæˆçš„æ©è†œæ•°é‡ã€‚
                - np.ndarray: é•¿åº¦ä¸º C çš„æ•°ç»„ï¼ŒåŒ…å«æ¨¡å‹ä¸ºæ¯ä¸ªæ©è†œé¢„æµ‹çš„è´¨é‡åˆ†æ•°ã€‚
                - np.ndarray: å½¢çŠ¶ä¸º CxHxW çš„ä½åˆ†è¾¨ç‡logitsï¼Œç”¨äºåç»­æ¨ç†ï¼ŒH=W=256ã€‚
        """
        # å¦‚æœself.promptsä¸­æœ‰å­˜å‚¨çš„æç¤ºï¼Œåˆ™è¦†ç›–
        bboxes = self.prompts.pop("bboxes", bboxes)
        points = self.prompts.pop("points", points)
        masks = self.prompts.pop("masks", masks)

        if all(i is None for i in [bboxes, points, masks]):
            return self.generate(im, *args, **kwargs)  # å¦‚æœæ²¡æœ‰æç¤ºï¼Œç”Ÿæˆæ©è†œ

        return self.prompt_inference(im, bboxes, points, labels, masks, multimask_output)  # åŸºäºæç¤ºè¿›è¡Œæ¨ç†

    def generate(self, im, crop_n_layers=0, crop_overlap_ratio=512 / 1500, crop_downscale_factor=1, 
                 point_grids=None, points_stride=32, points_batch_size=64, conf_thres=0.88, 
                 stability_score_thresh=0.95, stability_score_offset=0.95, crop_nms_thresh=0.7):
        """
        ä½¿ç”¨Segment Anything Model (SAM)æ‰§è¡Œå›¾åƒåˆ†å‰²ã€‚

        Args:
            im (torch.Tensor): è¾“å…¥å¼ é‡ï¼Œè¡¨ç¤ºé¢„å¤„ç†åçš„å›¾åƒï¼Œç»´åº¦ä¸º (N, C, H, W)ã€‚
            crop_n_layers (int): æŒ‡å®šç”¨äºå›¾åƒè£å‰ªçš„é¢å¤–æ©è†œé¢„æµ‹çš„å±‚æ•°ã€‚
            crop_overlap_ratio (float): è£å‰ªä¹‹é—´çš„é‡å ç¨‹åº¦ã€‚
            crop_downscale_factor (int): æ¯å±‚ä¸­é‡‡æ ·ç‚¹çš„ç¼©æ”¾å› å­ã€‚
            point_grids (list[np.ndarray], optional): è‡ªå®šä¹‰ç‚¹é‡‡æ ·ç½‘æ ¼ï¼Œå½’ä¸€åŒ–åˆ° [0,1]ã€‚
            points_stride (int, optional): æ²¿å›¾åƒæ¯è¾¹é‡‡æ ·çš„ç‚¹æ•°ã€‚
            points_batch_size (int): åŒæ—¶å¤„ç†çš„ç‚¹çš„æ‰¹é‡å¤§å°ã€‚
            conf_thres (float): æ ¹æ®æ¨¡å‹çš„æ©è†œè´¨é‡é¢„æµ‹è¿›è¡Œè¿‡æ»¤çš„ç½®ä¿¡åº¦é˜ˆå€¼ã€‚
            stability_score_thresh (float): åŸºäºæ©è†œç¨³å®šæ€§è¿›è¡Œè¿‡æ»¤çš„ç¨³å®šæ€§é˜ˆå€¼ã€‚
            stability_score_offset (float): è®¡ç®—ç¨³å®šæ€§åˆ†æ•°çš„åç§»å€¼ã€‚
            crop_nms_thresh (float): ç”¨äºå»é™¤è£å‰ªä¹‹é—´é‡å¤æ©è†œçš„éæœ€å¤§æŠ‘åˆ¶ï¼ˆNMSï¼‰çš„IoUæˆªæ­¢å€¼ã€‚

        Returns:
            (tuple): åŒ…å«åˆ†å‰²æ©è†œã€ç½®ä¿¡åº¦åˆ†æ•°å’Œè¾¹ç•Œæ¡†çš„å…ƒç»„ã€‚
        """
        self.segment_all = True  # è®¾ç½®ä¸ºåˆ†å‰²æ‰€æœ‰å¯¹è±¡
        ih, iw = im.shape[2:]  # è·å–è¾“å…¥å›¾åƒçš„é«˜åº¦å’Œå®½åº¦
        crop_regions, layer_idxs = generate_crop_boxes((ih, iw), crop_n_layers, crop_overlap_ratio)  # ç”Ÿæˆè£å‰ªåŒºåŸŸ
        if point_grids is None:
            point_grids = build_all_layer_point_grids(points_stride, crop_n_layers, crop_downscale_factor)  # æ„å»ºç‚¹ç½‘æ ¼
        pred_masks, pred_scores, pred_bboxes, region_areas = [], [], [], []  # åˆå§‹åŒ–é¢„æµ‹ç»“æœ

        # éå†æ¯ä¸ªè£å‰ªåŒºåŸŸ
        for crop_region, layer_idx in zip(crop_regions, layer_idxs):
            x1, y1, x2, y2 = crop_region  # è·å–è£å‰ªåŒºåŸŸçš„åæ ‡
            w, h = x2 - x1, y2 - y1  # è®¡ç®—è£å‰ªåŒºåŸŸçš„å®½å’Œé«˜
            area = torch.tensor(w * h, device=im.device)  # è®¡ç®—åŒºåŸŸé¢ç§¯
            points_scale = np.array([[w, h]])  # è£å‰ªåŒºåŸŸçš„å®½é«˜æ¯”ä¾‹

            # è£å‰ªå›¾åƒå¹¶æ’å€¼åˆ°è¾“å…¥å¤§å°
            crop_im = F.interpolate(im[..., y1:y2, x1:x2], (ih, iw), mode="bilinear", align_corners=False)
            points_for_image = point_grids[layer_idx] * points_scale  # æ ¹æ®è£å‰ªåŒºåŸŸç¼©æ”¾ç‚¹

            crop_masks, crop_scores, crop_bboxes = [], [], []  # åˆå§‹åŒ–è£å‰ªç»“æœ
            for (points,) in batch_iterator(points_batch_size, points_for_image):  # æ‰¹é‡å¤„ç†ç‚¹
                pred_mask, pred_score = self.prompt_inference(crop_im, points=points, multimask_output=True)  # æ¨ç†
                pred_mask = F.interpolate(pred_mask[None], (h, w), mode="bilinear", align_corners=False)[0]  # æ’å€¼æ©è†œ
                idx = pred_score > conf_thres  # æ ¹æ®ç½®ä¿¡åº¦é˜ˆå€¼è¿‡æ»¤æ©è†œ
                pred_mask, pred_score = pred_mask[idx], pred_score[idx]

                stability_score = calculate_stability_score(pred_mask, self.model.mask_threshold, stability_score_offset)  # è®¡ç®—ç¨³å®šæ€§åˆ†æ•°
                idx = stability_score > stability_score_thresh  # æ ¹æ®ç¨³å®šæ€§é˜ˆå€¼è¿‡æ»¤æ©è†œ
                pred_mask, pred_score = pred_mask[idx], pred_score[idx]
                pred_mask = pred_mask > self.model.mask_threshold  # è½¬æ¢ä¸ºå¸ƒå°”ç±»å‹æ©è†œ
                pred_bbox = batched_mask_to_box(pred_mask).float()  # è®¡ç®—è¾¹ç•Œæ¡†
                keep_mask = ~is_box_near_crop_edge(pred_bbox, crop_region, [0, 0, iw, ih])  # è¿‡æ»¤é è¿‘è£å‰ªè¾¹ç¼˜çš„æ¡†
                if not torch.all(keep_mask):
                    pred_bbox, pred_mask, pred_score = pred_bbox[keep_mask], pred_mask[keep_mask], pred_score[keep_mask]

                crop_masks.append(pred_mask)  # æ·»åŠ æ©è†œ
                crop_bboxes.append(pred_bbox)  # æ·»åŠ è¾¹ç•Œæ¡†
                crop_scores.append(pred_score)  # æ·»åŠ åˆ†æ•°

            # åœ¨æ­¤è£å‰ªåŒºåŸŸå†…æ‰§è¡ŒNMS
            crop_masks = torch.cat(crop_masks)  # åˆå¹¶æ©è†œ
            crop_bboxes = torch.cat(crop_bboxes)  # åˆå¹¶è¾¹ç•Œæ¡†
            crop_scores = torch.cat(crop_scores)  # åˆå¹¶åˆ†æ•°
            keep = torchvision.ops.nms(crop_bboxes, crop_scores, self.args.iou)  # NMS
            crop_bboxes = uncrop_boxes_xyxy(crop_bboxes[keep], crop_region)  # è§£è£å‰ªè¾¹ç•Œæ¡†
            crop_masks = uncrop_masks(crop_masks[keep], crop_region, ih, iw)  # è§£è£å‰ªæ©è†œ
            crop_scores = crop_scores[keep]  # ä¿ç•™åˆ†æ•°

            pred_masks.append(crop_masks)  # æ·»åŠ è£å‰ªæ©è†œ
            pred_bboxes.append(crop_bboxes)  # æ·»åŠ è£å‰ªè¾¹ç•Œæ¡†
            pred_scores.append(crop_scores)  # æ·»åŠ è£å‰ªåˆ†æ•°
            region_areas.append(area.expand(len(crop_masks)))  # æ·»åŠ åŒºåŸŸé¢ç§¯

        pred_masks = torch.cat(pred_masks)  # åˆå¹¶æ‰€æœ‰æ©è†œ
        pred_bboxes = torch.cat(pred_bboxes)  # åˆå¹¶æ‰€æœ‰è¾¹ç•Œæ¡†
        pred_scores = torch.cat(pred_scores)  # åˆå¹¶æ‰€æœ‰åˆ†æ•°
        region_areas = torch.cat(region_areas)  # åˆå¹¶æ‰€æœ‰åŒºåŸŸé¢ç§¯

        # ç§»é™¤è£å‰ªä¹‹é—´çš„é‡å¤æ©è†œ
        if len(crop_regions) > 1:
            scores = 1 / region_areas  # è®¡ç®—åˆ†æ•°
            keep = torchvision.ops.nms(pred_bboxes, scores, crop_nms_thresh)  # NMS
            pred_masks, pred_bboxes, pred_scores = pred_masks[keep], pred_bboxes[keep], pred_scores[keep]

        return pred_masks, pred_scores, pred_bboxes  # è¿”å›æœ€ç»ˆç»“æœ
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **ç±»çš„å®šä¹‰**ï¼š`Predictor`ç±»ç”¨äºå¤„ç†å›¾åƒåˆ†å‰²ä»»åŠ¡ï¼Œç»§æ‰¿è‡ª`BasePredictor`ï¼Œæä¾›äº†æ¨¡å‹æ¨ç†çš„æ¥å£ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼šè®¾ç½®æ¨¡å‹çš„é…ç½®ã€è¦†ç›–å’Œå›è°ƒï¼Œåˆå§‹åŒ–è¾“å…¥å›¾åƒã€ç‰¹å¾å’Œæç¤ºç­‰ã€‚
3. **é¢„å¤„ç†æ–¹æ³•**ï¼šå¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬è½¬æ¢ä¸ºå¼ é‡ã€å½’ä¸€åŒ–ç­‰ã€‚
4. **æ¨ç†æ–¹æ³•**ï¼šæ ¹æ®è¾“å…¥æç¤ºæ‰§è¡Œå›¾åƒåˆ†å‰²æ¨ç†ï¼Œæ”¯æŒå¤šç§æç¤ºç±»å‹ã€‚
5. **ç”Ÿæˆæ–¹æ³•**ï¼šæ‰§è¡Œå›¾åƒåˆ†å‰²ï¼Œæ”¯æŒè£å‰ªåŒºåŸŸå¤„ç†å’Œå¤šæ©è†œè¾“å‡ºï¼Œè¿”å›æœ€ç»ˆçš„æ©è†œã€åˆ†æ•°å’Œè¾¹ç•Œæ¡†ã€‚

è¿™äº›æ ¸å¿ƒéƒ¨åˆ†æ„æˆäº†å›¾åƒåˆ†å‰²çš„åŸºç¡€é€»è¾‘ï¼Œèƒ½å¤Ÿå¤„ç†è¾“å…¥å›¾åƒå¹¶ç”Ÿæˆç›¸åº”çš„åˆ†å‰²ç»“æœã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `ultralytics\models\sam\predict.py` æ˜¯ç”¨äºå®ç° Segment Anything Model (SAM) çš„é¢„æµ‹é€»è¾‘ï¼Œä¸»è¦ç”¨äºå›¾åƒåˆ†å‰²ä»»åŠ¡ã€‚SAM æ˜¯ä¸€ç§å…ˆè¿›çš„å›¾åƒåˆ†å‰²æ¨¡å‹ï¼Œå…·æœ‰å¯æç¤ºçš„åˆ†å‰²å’Œé›¶æ ·æœ¬æ€§èƒ½ã€‚è¯¥æ¨¡å—åŒ…å«äº†æ‰§è¡Œåˆ†å‰²æ‰€éœ€çš„é¢„æµ‹é€»è¾‘å’Œè¾…åŠ©å·¥å…·ï¼Œæ—¨åœ¨æ”¯æŒé«˜æ€§èƒ½çš„å®æ—¶å›¾åƒåˆ†å‰²ä»»åŠ¡ã€‚

æ–‡ä»¶ä¸­é¦–å…ˆå¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬ NumPyã€PyTorch å’Œ torchvisionï¼Œä»¥åŠ Ultralytics æ¡†æ¶ä¸­çš„ä¸€äº›å·¥å…·å’ŒåŠŸèƒ½ã€‚æ¥ç€å®šä¹‰äº†ä¸€ä¸ª `Predictor` ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª `BasePredictor`ï¼Œä¸ºå›¾åƒåˆ†å‰²ä»»åŠ¡æä¾›äº†æ¨¡å‹æ¨ç†çš„æ¥å£ã€‚è¯¥ç±»æ”¯æŒå¤šç§æç¤ºç±»å‹ï¼Œå¦‚è¾¹ç•Œæ¡†ã€ç‚¹å’Œä½åˆ†è¾¨ç‡æ©ç ï¼Œå¹¶èƒ½å¤Ÿçµæ´»åœ°ç”Ÿæˆå®æ—¶æ©ç ã€‚

åœ¨ `Predictor` ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œåˆå§‹åŒ–äº†ä¸€äº›å±æ€§ï¼ŒåŒ…æ‹¬é…ç½®å­—å…¸ã€è¦†ç›–çš„å‚æ•°ã€å›è°ƒå‡½æ•°ç­‰ã€‚è¿˜è®¾ç½®äº†ä¸€äº›ä¸ä»»åŠ¡ç›¸å…³çš„è®¾ç½®ï¼Œå¦‚ `retina_masks` ä¸º Trueï¼Œä»¥è·å¾—æœ€ä½³ç»“æœã€‚

`preprocess` æ–¹æ³•ç”¨äºå¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼Œæ”¯æŒå°†å›¾åƒè½¬æ¢ä¸º PyTorch å¼ é‡æ ¼å¼ï¼Œå¹¶è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ã€‚`pre_transform` æ–¹æ³•åˆ™å¯¹è¾“å…¥å›¾åƒè¿›è¡Œåˆæ­¥çš„å˜æ¢ï¼Œå¦‚è°ƒæ•´å¤§å°ï¼Œä»¥ä¾¿åç»­å¤„ç†ã€‚

`inference` æ–¹æ³•æ˜¯è¿›è¡Œå›¾åƒåˆ†å‰²æ¨ç†çš„æ ¸å¿ƒå‡½æ•°ï¼ŒåŸºäºç»™å®šçš„è¾“å…¥æç¤ºï¼ˆå¦‚è¾¹ç•Œæ¡†ã€ç‚¹ç­‰ï¼‰è¿›è¡Œåˆ†å‰²ã€‚è¯¥æ–¹æ³•ä¼šè°ƒç”¨ `prompt_inference` å‡½æ•°ï¼Œåè€…åˆ©ç”¨ SAM çš„æ¶æ„è¿›è¡Œå®æ—¶å’Œå¯æç¤ºçš„åˆ†å‰²ã€‚

`generate` æ–¹æ³•åˆ™ç”¨äºå¯¹æ•´ä¸ªå›¾åƒè¿›è¡Œåˆ†å‰²ï¼Œæ”¯æŒåœ¨å›¾åƒè£å‰ªä¸Šè¿›è¡Œæ›´ç²¾ç»†çš„åˆ†å‰²ã€‚è¯¥æ–¹æ³•ä¼šç”Ÿæˆè£å‰ªåŒºåŸŸï¼Œå¹¶åœ¨æ¯ä¸ªè£å‰ªåŒºåŸŸå†…è¿›è¡Œæ¨ç†ï¼Œæœ€åå°†ç»“æœåˆå¹¶ã€‚

`setup_model` æ–¹æ³•ç”¨äºåˆå§‹åŒ– SAM æ¨¡å‹ï¼Œå°†å…¶åˆ†é…åˆ°é€‚å½“çš„è®¾å¤‡ï¼Œå¹¶è®¾ç½®å›¾åƒå½’ä¸€åŒ–æ‰€éœ€çš„å‚æ•°ã€‚`postprocess` æ–¹æ³•ç”¨äºå¯¹æ¨¡å‹çš„è¾“å‡ºè¿›è¡Œåå¤„ç†ï¼Œç”Ÿæˆå¯¹è±¡æ£€æµ‹æ©ç å’Œè¾¹ç•Œæ¡†ï¼Œå¹¶å°†æ©ç å’Œæ¡†ç¼©æ”¾åˆ°åŸå§‹å›¾åƒå¤§å°ã€‚

æ­¤å¤–ï¼Œ`setup_source` æ–¹æ³•ç”¨äºé…ç½®æ¨ç†çš„æ•°æ®æºï¼Œ`set_image` æ–¹æ³•ç”¨äºè®¾ç½®å•å¼ å›¾åƒè¿›è¡Œæ¨ç†ï¼Œ`set_prompts` æ–¹æ³•ç”¨äºæå‰è®¾ç½®æç¤ºä¿¡æ¯ï¼Œ`reset_image` æ–¹æ³•åˆ™é‡ç½®å›¾åƒå’Œç‰¹å¾ã€‚

æœ€åï¼Œ`remove_small_regions` æ–¹æ³•ç”¨äºå¯¹ç”Ÿæˆçš„åˆ†å‰²æ©ç è¿›è¡Œåå¤„ç†ï¼Œå»é™¤å°çš„å­¤ç«‹åŒºåŸŸå’Œå­”æ´ï¼Œå¹¶æ‰§è¡Œéæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰ä»¥æ¶ˆé™¤é‡å¤çš„è¾¹ç•Œæ¡†ã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„æ¡†æ¶ï¼Œç”¨äºåˆ©ç”¨ SAM æ¨¡å‹è¿›è¡Œé«˜æ•ˆçš„å›¾åƒåˆ†å‰²ï¼Œæ”¯æŒå¤šç§è¾“å…¥æç¤ºæ–¹å¼ï¼Œå¹¶æä¾›äº†å¿…è¦çš„é¢„å¤„ç†å’Œåå¤„ç†åŠŸèƒ½ã€‚

#### 11.3 ultralytics\utils\tuner.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import subprocess
from ultralytics.utils import LOGGER, NUM_THREADS
from ray import tune
from ray.air import RunConfig
from ray.tune.schedulers import ASHAScheduler
from ray.air.integrations.wandb import WandbLoggerCallback

def run_ray_tune(
    model, space: dict = None, grace_period: int = 10, gpu_per_trial: int = None, max_samples: int = 10, **train_args
):
    """
    ä½¿ç”¨ Ray Tune è¿›è¡Œè¶…å‚æ•°è°ƒä¼˜ã€‚

    å‚æ•°:
        model (YOLO): è¦è¿›è¡Œè°ƒä¼˜çš„æ¨¡å‹ã€‚
        space (dict, optional): è¶…å‚æ•°æœç´¢ç©ºé—´ã€‚é»˜è®¤ä¸º Noneã€‚
        grace_period (int, optional): ASHA è°ƒåº¦å™¨çš„å®½é™æœŸï¼ˆä»¥ epochs ä¸ºå•ä½ï¼‰ã€‚é»˜è®¤ä¸º 10ã€‚
        gpu_per_trial (int, optional): æ¯ä¸ªè¯•éªŒåˆ†é…çš„ GPU æ•°é‡ã€‚é»˜è®¤ä¸º Noneã€‚
        max_samples (int, optional): è¦è¿è¡Œçš„æœ€å¤§è¯•éªŒæ¬¡æ•°ã€‚é»˜è®¤ä¸º 10ã€‚
        train_args (dict, optional): ä¼ é€’ç»™ `train()` æ–¹æ³•çš„å…¶ä»–å‚æ•°ã€‚é»˜è®¤ä¸º {}ã€‚

    è¿”å›:
        (dict): åŒ…å«è¶…å‚æ•°æœç´¢ç»“æœçš„å­—å…¸ã€‚
    """

    # æ—¥å¿—è®°å½• Ray Tune çš„å­¦ä¹ é“¾æ¥
    LOGGER.info("ğŸ’¡ Learn about RayTune at https://docs.ultralytics.com/integrations/ray-tune")

    # å®‰è£… Ray Tune åº“
    subprocess.run("pip install ray[tune]".split(), check=True)

    # å®šä¹‰é»˜è®¤çš„è¶…å‚æ•°æœç´¢ç©ºé—´
    default_space = {
        "lr0": tune.uniform(1e-5, 1e-1),  # åˆå§‹å­¦ä¹ ç‡
        "lrf": tune.uniform(0.01, 1.0),  # æœ€ç»ˆå­¦ä¹ ç‡çš„æ¯”ä¾‹
        "momentum": tune.uniform(0.6, 0.98),  # åŠ¨é‡
        "weight_decay": tune.uniform(0.0, 0.001),  # æƒé‡è¡°å‡
        "warmup_epochs": tune.uniform(0.0, 5.0),  # é¢„çƒ­ epochs
        "box": tune.uniform(0.02, 0.2),  # è¾¹æ¡†æŸå¤±å¢ç›Š
        "cls": tune.uniform(0.2, 4.0),  # åˆ†ç±»æŸå¤±å¢ç›Š
        # å…¶ä»–æ•°æ®å¢å¼ºå‚æ•°...
    }

    # å°†æ¨¡å‹æ”¾å…¥ Ray å­˜å‚¨ä¸­
    model_in_store = ray.put(model)

    def _tune(config):
        """
        ä½¿ç”¨æŒ‡å®šçš„è¶…å‚æ•°å’Œå…¶ä»–å‚æ•°è®­ç»ƒ YOLO æ¨¡å‹ã€‚

        å‚æ•°:
            config (dict): ç”¨äºè®­ç»ƒçš„è¶…å‚æ•°å­—å…¸ã€‚

        è¿”å›:
            None.
        """
        model_to_train = ray.get(model_in_store)  # ä» Ray å­˜å‚¨ä¸­è·å–æ¨¡å‹
        model_to_train.reset_callbacks()  # é‡ç½®å›è°ƒ
        config.update(train_args)  # æ›´æ–°è®­ç»ƒå‚æ•°
        results = model_to_train.train(**config)  # è®­ç»ƒæ¨¡å‹
        return results.results_dict  # è¿”å›ç»“æœå­—å…¸

    # è·å–æœç´¢ç©ºé—´
    if not space:
        space = default_space  # å¦‚æœæ²¡æœ‰æä¾›æœç´¢ç©ºé—´ï¼Œåˆ™ä½¿ç”¨é»˜è®¤ç©ºé—´

    # å®šä¹‰å¯è®­ç»ƒå‡½æ•°å¹¶åˆ†é…èµ„æº
    trainable_with_resources = tune.with_resources(_tune, {"cpu": NUM_THREADS, "gpu": gpu_per_trial or 0})

    # å®šä¹‰ ASHA è°ƒåº¦å™¨
    asha_scheduler = ASHAScheduler(
        time_attr="epoch",
        metric="metric_name",  # éœ€è¦æ ¹æ®ä»»åŠ¡å®šä¹‰çš„æŒ‡æ ‡
        mode="max",
        max_t=100,  # æœ€å¤§è®­ç»ƒ epochs
        grace_period=grace_period,
        reduction_factor=3,
    )

    # å®šä¹‰ Ray Tune è¶…å‚æ•°æœç´¢è°ƒä¼˜å™¨
    tuner = tune.Tuner(
        trainable_with_resources,
        param_space=space,
        tune_config=tune.TuneConfig(scheduler=asha_scheduler, num_samples=max_samples),
        run_config=RunConfig(callbacks=[], storage_path="tune_dir"),  # å­˜å‚¨è·¯å¾„
    )

    # è¿è¡Œè¶…å‚æ•°æœç´¢
    tuner.fit()

    # è¿”å›è¶…å‚æ•°æœç´¢çš„ç»“æœ
    return tuner.get_results()
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **å¯¼å…¥å¿…è¦çš„åº“**ï¼šå¯¼å…¥äº†ç”¨äºè¶…å‚æ•°è°ƒä¼˜çš„ Ray Tune ç›¸å…³åº“å’Œå…¶ä»–å·¥å…·ã€‚
2. **å®šä¹‰ `run_ray_tune` å‡½æ•°**ï¼šè¯¥å‡½æ•°æ˜¯è¿›è¡Œè¶…å‚æ•°è°ƒä¼˜çš„ä¸»è¦å…¥å£ï¼Œæ¥å—æ¨¡å‹ã€è¶…å‚æ•°ç©ºé—´ã€è®­ç»ƒå‚æ•°ç­‰ã€‚
3. **å®‰è£… Ray Tune**ï¼šç¡®ä¿ç¯å¢ƒä¸­å®‰è£…äº† Ray Tuneã€‚
4. **å®šä¹‰é»˜è®¤è¶…å‚æ•°ç©ºé—´**ï¼šè®¾ç½®äº†æ¨¡å‹è®­ç»ƒä¸­å¯èƒ½éœ€è¦è°ƒæ•´çš„è¶…å‚æ•°çš„èŒƒå›´ã€‚
5. **å®šä¹‰ `_tune` å‡½æ•°**ï¼šè¯¥å‡½æ•°è´Ÿè´£ä½¿ç”¨ç»™å®šçš„è¶…å‚æ•°è®­ç»ƒæ¨¡å‹ï¼Œå¹¶è¿”å›è®­ç»ƒç»“æœã€‚
6. **è®¾ç½®è°ƒåº¦å™¨å’Œè°ƒä¼˜å™¨**ï¼šä½¿ç”¨ ASHA è°ƒåº¦å™¨æ¥ç®¡ç†è¶…å‚æ•°æœç´¢è¿‡ç¨‹ï¼Œå¹¶å®šä¹‰è°ƒä¼˜å™¨æ¥æ‰§è¡Œæœç´¢ã€‚
7. **è¿è¡Œè¶…å‚æ•°æœç´¢**ï¼šè°ƒç”¨ `tuner.fit()` å¼€å§‹æœç´¢ï¼Œå¹¶è¿”å›ç»“æœã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `ultralytics/utils/tuner.py` æ˜¯ç”¨äºåœ¨ Ultralytics YOLO æ¡†æ¶ä¸­è¿›è¡Œè¶…å‚æ•°è°ƒä¼˜çš„å·¥å…·ã€‚è¯¥æ–‡ä»¶çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯é€šè¿‡ Ray Tune åº“æ¥ä¼˜åŒ–æ¨¡å‹çš„è¶…å‚æ•°ï¼Œä»è€Œæé«˜æ¨¡å‹çš„æ€§èƒ½ã€‚

ç¨‹åºé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `subprocess` ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œä»¥åŠä¸€äº›æ¥è‡ª `ultralytics` çš„é…ç½®å’Œå·¥å…·å‡½æ•°ã€‚æ¥ç€å®šä¹‰äº†ä¸€ä¸ªåä¸º `run_ray_tune` çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—å¤šä¸ªå‚æ•°ï¼Œå…¶ä¸­åŒ…æ‹¬æ¨¡å‹ã€è¶…å‚æ•°æœç´¢ç©ºé—´ã€è®­ç»ƒå‚æ•°ç­‰ã€‚

å‡½æ•°çš„ä¸»è¦ç›®çš„æ˜¯æ‰§è¡Œè¶…å‚æ•°è°ƒä¼˜ã€‚å®ƒé¦–å…ˆä¼šè¾“å‡ºä¸€æ¡ä¿¡æ¯ï¼Œæç¤ºç”¨æˆ·äº†è§£ Ray Tune çš„æ–‡æ¡£ã€‚æ¥ç€ï¼Œç¨‹åºå°è¯•å®‰è£… Ray Tune åº“ï¼Œå¦‚æœå®‰è£…å¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚éšåï¼Œç¨‹åºä¼šå¯¼å…¥ Ray å’Œ Tune ç›¸å…³çš„æ¨¡å—ï¼Œä»¥åŠ Wandbï¼ˆWeights & Biasesï¼‰ç”¨äºè®°å½•å®éªŒçš„ç»“æœã€‚

åœ¨è¶…å‚æ•°çš„å®šä¹‰éƒ¨åˆ†ï¼Œç¨‹åºè®¾å®šäº†ä¸€äº›é»˜è®¤çš„è¶…å‚æ•°æœç´¢ç©ºé—´ï¼ŒåŒ…æ‹¬å­¦ä¹ ç‡ã€åŠ¨é‡ã€æƒé‡è¡°å‡ç­‰ã€‚è¿™äº›è¶…å‚æ•°å¯¹äºæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹è‡³å…³é‡è¦ï¼Œåˆé€‚çš„å€¼å¯ä»¥æ˜¾è‘—æå‡æ¨¡å‹çš„æ€§èƒ½ã€‚

ç¨‹åºæ¥ä¸‹æ¥å°†æ¨¡å‹æ”¾å…¥ Ray çš„å­˜å‚¨ä¸­ï¼Œå¹¶å®šä¹‰äº†ä¸€ä¸ªå†…éƒ¨å‡½æ•° `_tune`ï¼Œè¯¥å‡½æ•°è´Ÿè´£ä½¿ç”¨ç»™å®šçš„è¶…å‚æ•°é…ç½®è®­ç»ƒæ¨¡å‹ï¼Œå¹¶è¿”å›è®­ç»ƒç»“æœã€‚ç„¶åï¼Œç¨‹åºä¼šæ£€æŸ¥æ˜¯å¦æä¾›äº†è¶…å‚æ•°æœç´¢ç©ºé—´ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„æœç´¢ç©ºé—´ï¼Œå¹¶å‘å‡ºè­¦å‘Šã€‚

æ¥ç€ï¼Œç¨‹åºè·å–æ•°æ®é›†ä¿¡æ¯ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°è¶…å‚æ•°ç©ºé—´ä¸­ã€‚å¦‚æœæ²¡æœ‰æä¾›æ•°æ®é›†ï¼Œç¨‹åºä¼šä½¿ç”¨é»˜è®¤çš„æ•°æ®é›†å¹¶å‘å‡ºè­¦å‘Šã€‚

ç„¶åï¼Œç¨‹åºå®šä¹‰äº†ä¸€ä¸ªå¯è®­ç»ƒçš„å‡½æ•°ï¼Œå¹¶æŒ‡å®šäº†èµ„æºåˆ†é…ï¼ŒåŒ…æ‹¬ CPU å’Œ GPU çš„æ•°é‡ã€‚æ¥ä¸‹æ¥ï¼Œç¨‹åºè®¾ç½®äº† ASHA è°ƒåº¦å™¨ï¼Œç”¨äºç®¡ç†è¶…å‚æ•°æœç´¢çš„è¿‡ç¨‹ï¼Œå¹¶å®šä¹‰äº†ç”¨äºè®°å½•çš„å›è°ƒå‡½æ•°ï¼ˆå¦‚æœä½¿ç”¨ Wandbï¼‰ã€‚

æœ€åï¼Œç¨‹åºåˆ›å»ºäº†ä¸€ä¸ª Ray Tune çš„è¶…å‚æ•°æœç´¢è°ƒä¼˜å™¨ï¼Œå¹¶æŒ‡å®šäº†å‚æ•°ç©ºé—´ã€è°ƒåº¦å™¨å’Œå›è°ƒå‡½æ•°ã€‚é€šè¿‡è°ƒç”¨ `tuner.fit()`ï¼Œç¨‹åºå¼€å§‹æ‰§è¡Œè¶…å‚æ•°æœç´¢ï¼Œæœ€ç»ˆè¿”å›æœç´¢ç»“æœã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªé«˜æ•ˆçš„æ–¹å¼æ¥ä¼˜åŒ– YOLO æ¨¡å‹çš„è¶…å‚æ•°ï¼Œä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡ç®€å•çš„æ¥å£è¿›è¡Œå¤æ‚çš„è°ƒä¼˜è¿‡ç¨‹ã€‚

#### 11.4 train.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import os
import torch
import yaml
from ultralytics import YOLO  # å¯¼å…¥YOLOæ¨¡å‹
from QtFusion.path import abs_path  # å¯¼å…¥è·¯å¾„å¤„ç†å‡½æ•°

# æ£€æµ‹æ˜¯å¦æœ‰å¯ç”¨çš„GPUï¼Œå¦‚æœæœ‰åˆ™ä½¿ç”¨GPUï¼Œå¦åˆ™ä½¿ç”¨CPU
device = "0" if torch.cuda.is_available() else "cpu"

if __name__ == '__main__':  # ç¡®ä¿è¯¥æ¨¡å—è¢«ç›´æ¥è¿è¡Œæ—¶æ‰æ‰§è¡Œä»¥ä¸‹ä»£ç 
    workers = 1  # è®¾ç½®æ•°æ®åŠ è½½çš„å·¥ä½œè¿›ç¨‹æ•°
    batch = 2    # è®¾ç½®æ¯ä¸ªæ‰¹æ¬¡çš„å¤§å°

    data_name = "data"  # æ•°æ®é›†åç§°
    # è·å–æ•°æ®é›†yamlæ–‡ä»¶çš„ç»å¯¹è·¯å¾„
    data_path = abs_path(f'datasets/{data_name}/{data_name}.yaml', path_type='current')  
    unix_style_path = data_path.replace(os.sep, '/')  # å°†è·¯å¾„è½¬æ¢ä¸ºUnixé£æ ¼

    # è·å–æ•°æ®é›†ç›®å½•è·¯å¾„
    directory_path = os.path.dirname(unix_style_path)
    
    # è¯»å–YAMLæ–‡ä»¶ï¼Œä¿æŒåŸæœ‰é¡ºåº
    with open(data_path, 'r') as file:
        data = yaml.load(file, Loader=yaml.FullLoader)
    
    # å¦‚æœYAMLæ–‡ä»¶ä¸­åŒ…å«'path'é¡¹ï¼Œåˆ™ä¿®æ”¹ä¸ºå½“å‰ç›®å½•è·¯å¾„
    if 'path' in data:
        data['path'] = directory_path
        # å°†ä¿®æ”¹åçš„æ•°æ®å†™å›YAMLæ–‡ä»¶
        with open(data_path, 'w') as file:
            yaml.safe_dump(data, file, sort_keys=False)

    # åŠ è½½é¢„è®­ç»ƒçš„YOLOv8æ¨¡å‹
    model = YOLO(model='./ultralytics/cfg/models/v8/yolov8s.yaml', task='detect')  
    
    # å¼€å§‹è®­ç»ƒæ¨¡å‹
    results2 = model.train(
        data=data_path,  # æŒ‡å®šè®­ç»ƒæ•°æ®çš„é…ç½®æ–‡ä»¶è·¯å¾„
        device=device,  # æŒ‡å®šä½¿ç”¨çš„è®¾å¤‡ï¼ˆGPUæˆ–CPUï¼‰
        workers=workers,  # æŒ‡å®šä½¿ç”¨çš„å·¥ä½œè¿›ç¨‹æ•°
        imgsz=640,  # æŒ‡å®šè¾“å…¥å›¾åƒçš„å¤§å°ä¸º640x640
        epochs=100,  # æŒ‡å®šè®­ç»ƒ100ä¸ªepoch
        batch=batch,  # æŒ‡å®šæ¯ä¸ªæ‰¹æ¬¡çš„å¤§å°
        name='train_v8_' + data_name  # æŒ‡å®šè®­ç»ƒä»»åŠ¡çš„åç§°
    )
```

### ä»£ç è¯´æ˜ï¼š
1. **å¯¼å…¥åº“**ï¼šå¯¼å…¥å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬`os`ã€`torch`ã€`yaml`å’ŒYOLOæ¨¡å‹ã€‚
2. **è®¾å¤‡é€‰æ‹©**ï¼šé€šè¿‡`torch.cuda.is_available()`æ£€æŸ¥æ˜¯å¦æœ‰å¯ç”¨çš„GPUï¼Œå¹¶ç›¸åº”åœ°è®¾ç½®è®¾å¤‡ã€‚
3. **æ•°æ®é›†è·¯å¾„å¤„ç†**ï¼šæ„å»ºæ•°æ®é›†çš„ç»å¯¹è·¯å¾„ï¼Œå¹¶ç¡®ä¿è·¯å¾„æ ¼å¼ä¸ºUnixé£æ ¼ã€‚
4. **è¯»å–å’Œä¿®æ”¹YAMLæ–‡ä»¶**ï¼šè¯»å–YAMLæ–‡ä»¶ï¼Œä¿®æ”¹å…¶ä¸­çš„`path`é¡¹ä¸ºå½“å‰ç›®å½•è·¯å¾„ï¼Œå¹¶å°†ä¿®æ”¹åçš„å†…å®¹å†™å›æ–‡ä»¶ã€‚
5. **æ¨¡å‹åŠ è½½**ï¼šåŠ è½½YOLOv8çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚
6. **æ¨¡å‹è®­ç»ƒ**ï¼šè°ƒç”¨`model.train()`æ–¹æ³•å¼€å§‹è®­ç»ƒï¼Œä¼ å…¥å¿…è¦çš„å‚æ•°ï¼ŒåŒ…æ‹¬æ•°æ®è·¯å¾„ã€è®¾å¤‡ã€å·¥ä½œè¿›ç¨‹æ•°ã€å›¾åƒå¤§å°ã€è®­ç»ƒè½®æ•°å’Œæ‰¹æ¬¡å¤§å°ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ç”¨äºè®­ç»ƒ YOLOv8 æ¨¡å‹çš„è„šæœ¬ã€‚é¦–å…ˆï¼Œç¨‹åºå¯¼å…¥äº†å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬ `os`ã€`torch`ã€`yaml` å’Œ `ultralytics` ä¸­çš„ YOLO æ¨¡å‹ã€‚æ¥ç€ï¼Œç¨‹åºé€šè¿‡æ£€æŸ¥ CUDA æ˜¯å¦å¯ç”¨æ¥å†³å®šä½¿ç”¨ GPU è¿˜æ˜¯ CPU è¿›è¡Œè®­ç»ƒã€‚

åœ¨ `if __name__ == '__main__':` è¿™ä¸€éƒ¨åˆ†ï¼Œç¨‹åºç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥è„šæœ¬æ—¶æ‰ä¼šæ‰§è¡Œä»¥ä¸‹ä»£ç ã€‚é¦–å…ˆï¼Œå®šä¹‰äº†å·¥ä½œè¿›ç¨‹æ•° `workers` å’Œæ‰¹æ¬¡å¤§å° `batch`ã€‚ç„¶åï¼ŒæŒ‡å®šäº†æ•°æ®é›†çš„åç§° `data_name`ï¼Œå¹¶æ„å»ºäº†æ•°æ®é›† YAML æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚æ¥ä¸‹æ¥ï¼Œç¨‹åºå°†è·¯å¾„ä¸­çš„åˆ†éš”ç¬¦æ›¿æ¢ä¸º Unix é£æ ¼çš„æ–œæ ï¼Œä»¥ç¡®ä¿è·¯å¾„çš„å…¼å®¹æ€§ã€‚

ç¨‹åºè·å–äº†æ•°æ®é›†ç›®å½•çš„è·¯å¾„ï¼Œå¹¶è¯»å–äº†æŒ‡å®šçš„ YAML æ–‡ä»¶ã€‚é€šè¿‡ä½¿ç”¨ `yaml` åº“ï¼Œç¨‹åºä¿æŒäº†æ–‡ä»¶çš„åŸæœ‰é¡ºåºï¼Œå¹¶åœ¨è¯»å–åæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `path` é¡¹ã€‚å¦‚æœå­˜åœ¨ï¼Œç¨‹åºå°†å…¶æ›´æ–°ä¸ºå½“å‰ç›®å½•è·¯å¾„ï¼Œå¹¶å°†ä¿®æ”¹åçš„æ•°æ®å†™å› YAML æ–‡ä»¶ã€‚

éšåï¼Œç¨‹åºåŠ è½½äº†é¢„è®­ç»ƒçš„ YOLOv8 æ¨¡å‹ï¼ŒæŒ‡å®šäº†æ¨¡å‹çš„é…ç½®æ–‡ä»¶ã€‚æ¥ä¸‹æ¥ï¼Œç¨‹åºè°ƒç”¨ `model.train()` æ–¹æ³•å¼€å§‹è®­ç»ƒæ¨¡å‹ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç¨‹åºæŒ‡å®šäº†è®­ç»ƒæ•°æ®çš„é…ç½®æ–‡ä»¶è·¯å¾„ã€è®¾å¤‡ï¼ˆCPU æˆ– GPUï¼‰ã€å·¥ä½œè¿›ç¨‹æ•°ã€è¾“å…¥å›¾åƒçš„å¤§å°ï¼ˆ640x640ï¼‰ã€è®­ç»ƒçš„ epoch æ•°ï¼ˆ100ï¼‰ä»¥åŠæ¯ä¸ªæ‰¹æ¬¡çš„å¤§å°ï¼ˆ2ï¼‰ã€‚æœ€åï¼Œè®­ç»ƒä»»åŠ¡çš„åç§°ä¹Ÿè¢«è®¾ç½®ä¸º `'train_v8_'` åŠ ä¸Šæ•°æ®é›†åç§°ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯é…ç½®å¹¶å¯åŠ¨ YOLOv8 æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼Œç¡®ä¿æ•°æ®é›†è·¯å¾„æ­£ç¡®ï¼Œå¹¶èƒ½å¤Ÿæ ¹æ®å¯ç”¨çš„è®¡ç®—èµ„æºé€‰æ‹©åˆé€‚çš„è®¾å¤‡è¿›è¡Œè®­ç»ƒã€‚

#### 11.5 ultralytics\data\loaders.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import cv2
import numpy as np
import torch
from pathlib import Path
from threading import Thread
from ultralytics.utils import LOGGER

class LoadStreams:
    """
    ç”¨äºåŠ è½½è§†é¢‘æµçš„ç±»ï¼Œæ”¯æŒå¤šç§è§†é¢‘æµæºï¼ŒåŒ…æ‹¬RTSPã€RTMPã€HTTPå’ŒTCPæµã€‚
    """

    def __init__(self, sources="file.streams", imgsz=640, vid_stride=1, buffer=False):
        """åˆå§‹åŒ–åŠ è½½æµçš„å‚æ•°å’Œè§†é¢‘æ•è·å¯¹è±¡ã€‚"""
        torch.backends.cudnn.benchmark = True  # å¯¹äºå›ºå®šå¤§å°çš„æ¨ç†åŠ é€Ÿ
        self.buffer = buffer  # æ˜¯å¦ç¼“å†²è¾“å…¥æµ
        self.running = True  # çº¿ç¨‹è¿è¡Œæ ‡å¿—
        self.imgsz = imgsz  # å›¾åƒå¤§å°
        self.vid_stride = vid_stride  # è§†é¢‘å¸§ç‡æ­¥å¹…

        # è¯»å–æºæ–‡ä»¶æˆ–ç›´æ¥ä½¿ç”¨æºå­—ç¬¦ä¸²
        sources = Path(sources).read_text().rsplit() if os.path.isfile(sources) else [sources]
        n = len(sources)
        self.fps = [0] * n  # æ¯ä¸ªæµçš„å¸§ç‡
        self.frames = [0] * n  # æ¯ä¸ªæµçš„æ€»å¸§æ•°
        self.threads = [None] * n  # çº¿ç¨‹åˆ—è¡¨
        self.caps = [None] * n  # è§†é¢‘æ•è·å¯¹è±¡åˆ—è¡¨
        self.imgs = [[] for _ in range(n)]  # æ¯ä¸ªæµçš„å›¾åƒå¸§åˆ—è¡¨
        self.shape = [[] for _ in range(n)]  # æ¯ä¸ªæµçš„å›¾åƒå½¢çŠ¶
        self.sources = [x.strip() for x in sources]  # æ¸…ç†æºåç§°

        for i, s in enumerate(sources):  # éå†æ¯ä¸ªæº
            self.caps[i] = cv2.VideoCapture(s)  # åˆ›å»ºè§†é¢‘æ•è·å¯¹è±¡
            if not self.caps[i].isOpened():
                raise ConnectionError(f"æ— æ³•æ‰“å¼€æµ {s}")
            w = int(self.caps[i].get(cv2.CAP_PROP_FRAME_WIDTH))  # è·å–å®½åº¦
            h = int(self.caps[i].get(cv2.CAP_PROP_FRAME_HEIGHT))  # è·å–é«˜åº¦
            fps = self.caps[i].get(cv2.CAP_PROP_FPS)  # è·å–å¸§ç‡
            self.frames[i] = max(int(self.caps[i].get(cv2.CAP_PROP_FRAME_COUNT)), 0) or float("inf")  # è·å–æ€»å¸§æ•°
            self.fps[i] = max((fps if fps > 0 else 30), 0)  # è®¾ç½®å¸§ç‡ï¼Œé»˜è®¤ä¸º30

            success, im = self.caps[i].read()  # è¯»å–ç¬¬ä¸€å¸§
            if not success or im is None:
                raise ConnectionError(f"æ— æ³•è¯»å–æµ {s} çš„å›¾åƒ")
            self.imgs[i].append(im)  # å­˜å‚¨ç¬¬ä¸€å¸§
            self.shape[i] = im.shape  # å­˜å‚¨å›¾åƒå½¢çŠ¶
            self.threads[i] = Thread(target=self.update, args=([i, self.caps[i], s]), daemon=True)  # å¯åŠ¨çº¿ç¨‹è¯»å–å¸§
            self.threads[i].start()  # å¯åŠ¨çº¿ç¨‹

    def update(self, i, cap, stream):
        """åœ¨å®ˆæŠ¤çº¿ç¨‹ä¸­è¯»å–æµçš„å¸§ã€‚"""
        n = 0  # å¸§è®¡æ•°
        while self.running and cap.isOpened():
            if len(self.imgs[i]) < 30:  # ä¿æŒç¼“å†²åŒºä¸è¶…è¿‡30å¸§
                n += 1
                cap.grab()  # æŠ“å–ä¸‹ä¸€å¸§
                if n % self.vid_stride == 0:  # æ ¹æ®æ­¥å¹…è¯»å–å¸§
                    success, im = cap.retrieve()  # è·å–å¸§
                    if not success:
                        im = np.zeros(self.shape[i], dtype=np.uint8)  # å¦‚æœå¤±è´¥ï¼Œè¿”å›ç©ºå¸§
                    if self.buffer:
                        self.imgs[i].append(im)  # å¦‚æœç¼“å†²ï¼Œæ·»åŠ åˆ°åˆ—è¡¨
                    else:
                        self.imgs[i] = [im]  # å¦åˆ™æ›¿æ¢åˆ—è¡¨
            else:
                time.sleep(0.01)  # ç­‰å¾…ç¼“å†²åŒºç©ºé—²

    def close(self):
        """å…³é—­æµåŠ è½½å™¨å¹¶é‡Šæ”¾èµ„æºã€‚"""
        self.running = False  # åœæ­¢çº¿ç¨‹
        for thread in self.threads:
            if thread.is_alive():
                thread.join(timeout=5)  # ç­‰å¾…çº¿ç¨‹ç»“æŸ
        for cap in self.caps:  # é‡Šæ”¾è§†é¢‘æ•è·å¯¹è±¡
            cap.release()
        cv2.destroyAllWindows()  # å…³é—­æ‰€æœ‰OpenCVçª—å£

    def __iter__(self):
        """è¿”å›è¿­ä»£å™¨å¯¹è±¡ã€‚"""
        self.count = -1
        return self

    def __next__(self):
        """è¿”å›æºè·¯å¾„ã€è½¬æ¢åçš„å›¾åƒå’ŒåŸå§‹å›¾åƒä»¥ä¾›å¤„ç†ã€‚"""
        self.count += 1
        images = []
        for i, x in enumerate(self.imgs):
            while not x:  # ç­‰å¾…æ¯ä¸ªç¼“å†²åŒºä¸­çš„å¸§
                if not self.threads[i].is_alive():
                    self.close()
                    raise StopIteration
                time.sleep(1 / max(self.fps))  # ç­‰å¾…å¸§
                x = self.imgs[i]

            if self.buffer:
                images.append(x.pop(0))  # ä»ç¼“å†²åŒºè·å–å¹¶ç§»é™¤ç¬¬ä¸€å¸§
            else:
                images.append(x.pop(-1) if x else np.zeros(self.shape[i], dtype=np.uint8))  # è·å–æœ€åä¸€å¸§
                x.clear()  # æ¸…ç©ºç¼“å†²åŒº

        return self.sources, images, None, ""  # è¿”å›æºã€å›¾åƒå’Œå…¶ä»–ä¿¡æ¯

    def __len__(self):
        """è¿”å›æºå¯¹è±¡çš„é•¿åº¦ã€‚"""
        return len(self.sources)  # è¿”å›æºçš„æ•°é‡
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **LoadStreams ç±»**ï¼šè´Ÿè´£ä»è§†é¢‘æµä¸­è¯»å–å¸§ï¼Œæ”¯æŒå¤šç§æµæºï¼Œä½¿ç”¨å¤šçº¿ç¨‹æ¥ä¿è¯æµçš„å®æ—¶æ€§ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼šè®¾ç½®æµæºã€å›¾åƒå¤§å°ã€å¸§ç‡æ­¥å¹…ç­‰å‚æ•°ï¼Œå¹¶ä¸ºæ¯ä¸ªæµåˆ›å»ºè§†é¢‘æ•è·å¯¹è±¡ã€‚
3. **update æ–¹æ³•**ï¼šåœ¨åå°çº¿ç¨‹ä¸­ä¸æ–­è¯»å–è§†é¢‘æµçš„å¸§ï¼Œç¡®ä¿å¸§çš„å®æ—¶è·å–ã€‚
4. **close æ–¹æ³•**ï¼šé‡Šæ”¾èµ„æºï¼Œå…³é—­æ‰€æœ‰æ‰“å¼€çš„æµå’Œçª—å£ã€‚
5. **è¿­ä»£å™¨æ–¹æ³•**ï¼šæ”¯æŒé€šè¿‡ `__iter__` å’Œ `__next__` æ–¹æ³•éå†æµä¸­çš„å›¾åƒæ•°æ®ã€‚

é€šè¿‡è¿™äº›æ ¸å¿ƒéƒ¨åˆ†ï¼Œä»£ç å®ç°äº†å¯¹è§†é¢‘æµçš„é«˜æ•ˆç®¡ç†å’Œå¤„ç†ï¼Œä¸ºåç»­çš„ç›®æ ‡æ£€æµ‹ç­‰ä»»åŠ¡æä¾›äº†åŸºç¡€ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯Ultralytics YOLOæ¨¡å‹çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œä¸»è¦è´Ÿè´£åŠ è½½ä¸åŒç±»å‹çš„æ•°æ®æºï¼ŒåŒ…æ‹¬è§†é¢‘æµã€å›¾åƒã€å±å¹•æˆªå›¾å’Œå¼ é‡ã€‚æ–‡ä»¶ä¸­å®šä¹‰äº†å¤šä¸ªç±»ï¼Œæ¯ä¸ªç±»éƒ½æœ‰ç‰¹å®šçš„åŠŸèƒ½å’Œå±æ€§ï¼Œä»¥ä¾¿äºåœ¨è¿›è¡Œç›®æ ‡æ£€æµ‹æ—¶èƒ½å¤Ÿçµæ´»åœ°å¤„ç†è¾“å…¥æ•°æ®ã€‚

é¦–å…ˆï¼Œ`SourceTypes`ç±»ç”¨äºè¡¨ç¤ºå„ç§è¾“å…¥æºçš„ç±»å‹ï¼ŒåŒ…æ‹¬ç½‘ç»œæ‘„åƒå¤´ã€æˆªå›¾ã€å›¾åƒæ–‡ä»¶å’Œå¼ é‡ã€‚æ¥ä¸‹æ¥ï¼Œ`LoadStreams`ç±»æ˜¯ä¸€ä¸ªè§†é¢‘æµåŠ è½½å™¨ï¼Œæ”¯æŒRTSPã€RTMPã€HTTPå’ŒTCPæµã€‚å®ƒçš„æ„é€ å‡½æ•°åˆå§‹åŒ–äº†ä¸€äº›å‚æ•°ï¼ŒåŒ…æ‹¬è¾“å…¥æºã€å›¾åƒå¤§å°ã€è§†é¢‘å¸§ç‡æ­¥å¹…ç­‰ï¼Œå¹¶åˆ›å»ºäº†å¤šä¸ªçº¿ç¨‹æ¥è¯»å–è§†é¢‘æµçš„å¸§ã€‚è¯¥ç±»è¿˜å®ç°äº†è¿­ä»£å™¨æ–¹æ³•ï¼Œä½¿å¾—å¯ä»¥é€å¸§è¯»å–è§†é¢‘æµä¸­çš„å›¾åƒã€‚

`LoadScreenshots`ç±»åˆ™ç”¨äºå¤„ç†å±å¹•æˆªå›¾ï¼Œå®ƒåˆ©ç”¨`mss`åº“æ¥æ•è·å±å¹•ä¸Šçš„å›¾åƒã€‚æ„é€ å‡½æ•°ä¸­è®¾ç½®äº†æ•è·åŒºåŸŸçš„å‚æ•°ï¼Œå¹¶æä¾›äº†è¿­ä»£å™¨æ–¹æ³•æ¥è·å–ä¸‹ä¸€å¸§æˆªå›¾ã€‚

`LoadImages`ç±»è´Ÿè´£åŠ è½½å›¾åƒå’Œè§†é¢‘æ–‡ä»¶ã€‚å®ƒæ”¯æŒä»æ–‡ä»¶è·¯å¾„ã€ç›®å½•æˆ–æ–‡æœ¬æ–‡ä»¶ä¸­è¯»å–å›¾åƒå’Œè§†é¢‘ï¼Œå¹¶èƒ½å¤Ÿæ ¹æ®æ–‡ä»¶ç±»å‹è¿›è¡Œåˆ†ç±»ã€‚è¯¥ç±»çš„è¿­ä»£å™¨æ–¹æ³•å…è®¸é€ä¸ªè¿”å›å›¾åƒæˆ–è§†é¢‘å¸§ã€‚

`LoadPilAndNumpy`ç±»ç”¨äºä»PILå›¾åƒå’ŒNumpyæ•°ç»„ä¸­åŠ è½½å›¾åƒæ•°æ®ã€‚å®ƒæä¾›äº†åŸºæœ¬çš„éªŒè¯å’Œæ ¼å¼è½¬æ¢ï¼Œç¡®ä¿å›¾åƒç¬¦åˆåç»­å¤„ç†çš„è¦æ±‚ã€‚

`LoadTensor`ç±»åˆ™ä¸“æ³¨äºä»PyTorchå¼ é‡ä¸­åŠ è½½å›¾åƒæ•°æ®ã€‚å®ƒéªŒè¯è¾“å…¥çš„å¼ é‡æ ¼å¼ï¼Œå¹¶ç¡®ä¿å…¶ç¬¦åˆæ¨¡å‹çš„è¾“å…¥è¦æ±‚ã€‚

æ­¤å¤–ï¼Œæ–‡ä»¶ä¸­è¿˜å®šä¹‰äº†ä¸€ä¸ª`autocast_list`å‡½æ•°ï¼Œç”¨äºå°†ä¸åŒç±»å‹çš„è¾“å…¥æºåˆå¹¶ä¸ºNumpyæ•°ç»„æˆ–PILå›¾åƒçš„åˆ—è¡¨ã€‚æœ€åï¼Œ`get_best_youtube_url`å‡½æ•°ç”¨äºä»ç»™å®šçš„YouTubeè§†é¢‘é“¾æ¥ä¸­æå–æœ€ä½³è´¨é‡çš„MP4è§†é¢‘æµURLã€‚

æ•´ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸ºYOLOæ¨¡å‹æä¾›äº†çµæ´»çš„æ•°æ®åŠ è½½åŠŸèƒ½ï¼Œæ”¯æŒå¤šç§è¾“å…¥æºï¼Œæ–¹ä¾¿ç”¨æˆ·åœ¨ä¸åŒç¯å¢ƒä¸‹è¿›è¡Œç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚

#### 11.6 ultralytics\models\yolo\model.py

```python
# å¯¼å…¥å¿…è¦çš„æ¨¡å—å’Œç±»
from ultralytics.engine.model import Model
from ultralytics.models import yolo
from ultralytics.nn.tasks import ClassificationModel, DetectionModel, OBBModel, PoseModel, SegmentationModel

class YOLO(Model):
    """YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„å®šä¹‰ã€‚"""

    @property
    def task_map(self):
        """å°†ä»»åŠ¡ç±»å‹æ˜ å°„åˆ°ç›¸åº”çš„æ¨¡å‹ã€è®­ç»ƒå™¨ã€éªŒè¯å™¨å’Œé¢„æµ‹å™¨ç±»ã€‚"""
        return {
            "classify": {  # åˆ†ç±»ä»»åŠ¡
                "model": ClassificationModel,  # ä½¿ç”¨çš„æ¨¡å‹ç±»
                "trainer": yolo.classify.ClassificationTrainer,  # è®­ç»ƒå™¨ç±»
                "validator": yolo.classify.ClassificationValidator,  # éªŒè¯å™¨ç±»
                "predictor": yolo.classify.ClassificationPredictor,  # é¢„æµ‹å™¨ç±»
            },
            "detect": {  # æ£€æµ‹ä»»åŠ¡
                "model": DetectionModel,  # ä½¿ç”¨çš„æ¨¡å‹ç±»
                "trainer": yolo.detect.DetectionTrainer,  # è®­ç»ƒå™¨ç±»
                "validator": yolo.detect.DetectionValidator,  # éªŒè¯å™¨ç±»
                "predictor": yolo.detect.DetectionPredictor,  # é¢„æµ‹å™¨ç±»
            },
            "segment": {  # åˆ†å‰²ä»»åŠ¡
                "model": SegmentationModel,  # ä½¿ç”¨çš„æ¨¡å‹ç±»
                "trainer": yolo.segment.SegmentationTrainer,  # è®­ç»ƒå™¨ç±»
                "validator": yolo.segment.SegmentationValidator,  # éªŒè¯å™¨ç±»
                "predictor": yolo.segment.SegmentationPredictor,  # é¢„æµ‹å™¨ç±»
            },
            "pose": {  # å§¿æ€ä¼°è®¡ä»»åŠ¡
                "model": PoseModel,  # ä½¿ç”¨çš„æ¨¡å‹ç±»
                "trainer": yolo.pose.PoseTrainer,  # è®­ç»ƒå™¨ç±»
                "validator": yolo.pose.PoseValidator,  # éªŒè¯å™¨ç±»
                "predictor": yolo.pose.PosePredictor,  # é¢„æµ‹å™¨ç±»
            },
            "obb": {  # æ–¹å‘è¾¹ç•Œæ¡†ä»»åŠ¡
                "model": OBBModel,  # ä½¿ç”¨çš„æ¨¡å‹ç±»
                "trainer": yolo.obb.OBBTrainer,  # è®­ç»ƒå™¨ç±»
                "validator": yolo.obb.OBBValidator,  # éªŒè¯å™¨ç±»
                "predictor": yolo.obb.OBBPredictor,  # é¢„æµ‹å™¨ç±»
            },
        }
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š
1. **å¯¼å…¥æ¨¡å—**ï¼šé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—å’Œç±»ï¼ŒåŒ…æ‹¬åŸºç¡€çš„ `Model` ç±»å’Œ YOLO ç›¸å…³çš„æ¨¡å‹ã€è®­ç»ƒå™¨ã€éªŒè¯å™¨å’Œé¢„æµ‹å™¨ã€‚
  
2. **YOLO ç±»**ï¼šå®šä¹‰äº†ä¸€ä¸ªåä¸º `YOLO` çš„ç±»ï¼Œç»§æ‰¿è‡ª `Model` ç±»ï¼Œè¡¨ç¤º YOLO ç›®æ ‡æ£€æµ‹æ¨¡å‹ã€‚

3. **task_map å±æ€§**ï¼šå®šä¹‰äº†ä¸€ä¸ªå±æ€§ `task_map`ï¼Œç”¨äºå°†ä¸åŒçš„ä»»åŠ¡ç±»å‹ï¼ˆå¦‚åˆ†ç±»ã€æ£€æµ‹ã€åˆ†å‰²ã€å§¿æ€ä¼°è®¡å’Œæ–¹å‘è¾¹ç•Œæ¡†ï¼‰æ˜ å°„åˆ°ç›¸åº”çš„æ¨¡å‹ã€è®­ç»ƒå™¨ã€éªŒè¯å™¨å’Œé¢„æµ‹å™¨ç±»ã€‚è¿™ç§è®¾è®¡ä½¿å¾—åœ¨ä½¿ç”¨ YOLO æ¨¡å‹æ—¶ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æ ¹æ®ä»»åŠ¡ç±»å‹é€‰æ‹©åˆé€‚çš„ç»„ä»¶ã€‚æ¯ä¸ªä»»åŠ¡éƒ½æœ‰å¯¹åº”çš„æ¨¡å‹å’Œå¤„ç†æµç¨‹ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `YOLO` çš„ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª `Model`ï¼Œç”¨äºå®ç° YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡å‹ã€‚YOLO æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œä¸»è¦ç”¨äºå®æ—¶ç‰©ä½“æ£€æµ‹ã€‚

åœ¨ `YOLO` ç±»ä¸­ï¼Œæœ‰ä¸€ä¸ªåä¸º `task_map` çš„å±æ€§ï¼Œå®ƒè¿”å›ä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸çš„é”®æ˜¯ä¸åŒçš„ä»»åŠ¡ç±»å‹ï¼ˆå¦‚åˆ†ç±»ã€æ£€æµ‹ã€åˆ†å‰²ã€å§¿æ€ä¼°è®¡å’Œæ–¹å‘è¾¹ç•Œæ¡†ï¼‰ï¼Œæ¯ä¸ªé”®å¯¹åº”çš„å€¼åˆæ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«äº†ä¸è¯¥ä»»åŠ¡ç›¸å…³çš„æ¨¡å‹ã€è®­ç»ƒå™¨ã€éªŒè¯å™¨å’Œé¢„æµ‹å™¨ç±»ã€‚è¿™ç§ç»“æ„ä½¿å¾—æ¨¡å‹å¯ä»¥æ ¹æ®ä¸åŒçš„ä»»åŠ¡çµæ´»åœ°è°ƒç”¨ç›¸åº”çš„ç»„ä»¶ã€‚

å…·ä½“æ¥è¯´ï¼Œ`task_map` ä¸­çš„æ¯ä¸ªä»»åŠ¡éƒ½åŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š
- `model`ï¼šå¯¹åº”çš„æ¨¡å‹ç±»ï¼Œä¾‹å¦‚ `ClassificationModel`ã€`DetectionModel` ç­‰ã€‚
- `trainer`ï¼šç”¨äºè®­ç»ƒæ¨¡å‹çš„ç±»ï¼Œå¦‚ `ClassificationTrainer`ã€`DetectionTrainer` ç­‰ã€‚
- `validator`ï¼šç”¨äºéªŒè¯æ¨¡å‹æ€§èƒ½çš„ç±»ï¼Œå¦‚ `ClassificationValidator`ã€`DetectionValidator` ç­‰ã€‚
- `predictor`ï¼šç”¨äºè¿›è¡Œé¢„æµ‹çš„ç±»ï¼Œå¦‚ `ClassificationPredictor`ã€`DetectionPredictor` ç­‰ã€‚

é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒYOLO ç±»èƒ½å¤Ÿä¸ºä¸åŒçš„ä»»åŠ¡æä¾›ç›¸åº”çš„æ”¯æŒï¼Œæ–¹ä¾¿ç”¨æˆ·åœ¨è¿›è¡Œç›®æ ‡æ£€æµ‹æˆ–å…¶ä»–ç›¸å…³ä»»åŠ¡æ—¶è¿›è¡Œé€‰æ‹©å’Œä½¿ç”¨ã€‚è¿™ç§è®¾è®¡ä½¿å¾—ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ„æ¶æ¦‚æ‹¬

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº Ultralytics YOLO æ¡†æ¶çš„ç›®æ ‡æ£€æµ‹å’Œå›¾åƒåˆ†å‰²ç³»ç»Ÿï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬æ¨¡å‹è®­ç»ƒã€æ¨ç†ã€è¶…å‚æ•°è°ƒä¼˜å’Œæ•°æ®åŠ è½½ã€‚é¡¹ç›®çš„ç»“æ„è®¾è®¡æ¸…æ™°ï¼Œæ¨¡å—åŒ–ç¨‹åº¦é«˜ï¼Œå„ä¸ªæ–‡ä»¶å’Œç±»çš„åŠŸèƒ½ç›¸å¯¹ç‹¬ç«‹ä½†åˆç›¸äº’åä½œï¼Œä»¥å®ç°å®Œæ•´çš„ç›®æ ‡æ£€æµ‹å·¥ä½œæµã€‚

- **æ¨¡å‹è®­ç»ƒ**ï¼šé€šè¿‡ `train.py` æ–‡ä»¶å¯åŠ¨æ¨¡å‹è®­ç»ƒï¼Œæ”¯æŒå¤šç§æ•°æ®æºå’Œé…ç½®ã€‚
- **æ¨ç†**ï¼šä½¿ç”¨ `predict.py` æ–‡ä»¶è¿›è¡Œæ¨¡å‹æ¨ç†ï¼Œæ”¯æŒå›¾åƒåˆ†å‰²å’Œç›®æ ‡æ£€æµ‹ã€‚
- **è¶…å‚æ•°è°ƒä¼˜**ï¼šé€šè¿‡ `tuner.py` æ–‡ä»¶è¿›è¡Œæ¨¡å‹è¶…å‚æ•°çš„è‡ªåŠ¨è°ƒä¼˜ï¼Œä»¥æé«˜æ¨¡å‹æ€§èƒ½ã€‚
- **æ•°æ®åŠ è½½**ï¼š`loaders.py` æ–‡ä»¶æä¾›å¤šç§æ•°æ®åŠ è½½æ–¹å¼ï¼Œæ”¯æŒå›¾åƒã€è§†é¢‘æµå’Œå¼ é‡ç­‰å¤šç§è¾“å…¥æ ¼å¼ã€‚
- **æ¨¡å‹å®šä¹‰**ï¼š`model.py` æ–‡ä»¶å®šä¹‰äº† YOLO æ¨¡å‹çš„åŸºæœ¬ç»“æ„ï¼Œæ”¯æŒä¸åŒä»»åŠ¡çš„çµæ´»è°ƒç”¨ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„                                      | åŠŸèƒ½æè¿°                                           |
|-------------------------------------------|--------------------------------------------------|
| `ui.py`                                   | å¯åŠ¨ Streamlit åº”ç”¨ä»¥è¿è¡ŒæŒ‡å®šçš„ Python è„šæœ¬ã€‚          |
| `ultralytics/models/sam/predict.py`      | å®ç° Segment Anything Model (SAM) çš„å›¾åƒåˆ†å‰²æ¨ç†é€»è¾‘ã€‚   |
| `ultralytics/utils/tuner.py`             | ä½¿ç”¨ Ray Tune è¿›è¡Œæ¨¡å‹è¶…å‚æ•°è°ƒä¼˜ã€‚                     |
| `train.py`                                | é…ç½®å¹¶å¯åŠ¨ YOLOv8 æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚                     |
| `ultralytics/data/loaders.py`            | æä¾›å¤šç§æ•°æ®åŠ è½½å™¨ï¼Œæ”¯æŒå›¾åƒã€è§†é¢‘æµå’Œå¼ é‡ç­‰è¾“å…¥ã€‚       |
| `ultralytics/models/yolo/model.py`       | å®šä¹‰ YOLO æ¨¡å‹åŠå…¶ä»»åŠ¡æ˜ å°„ï¼Œæ”¯æŒä¸åŒç±»å‹çš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚  |
| `web.py`                                  | æä¾›ä¸€ä¸ª Web æ¥å£ä»¥ä¾¿äºä¸æ¨¡å‹è¿›è¡Œäº¤äº’ï¼ˆå‡è®¾çš„æ–‡ä»¶ï¼‰ã€‚       |
| `ultralytics/models/yolo/pose/train.py`  | è®­ç»ƒ YOLO å§¿æ€ä¼°è®¡æ¨¡å‹çš„ç›¸å…³é€»è¾‘ï¼ˆå‡è®¾çš„æ–‡ä»¶ï¼‰ã€‚           |
| `ultralytics/utils/tal.py`               | æä¾›ä¸ç›®æ ‡æ£€æµ‹ç›¸å…³çš„å·¥å…·å’Œè¾…åŠ©å‡½æ•°ï¼ˆå‡è®¾çš„æ–‡ä»¶ï¼‰ã€‚         |
| `ultralytics/__init__.py`                | åˆå§‹åŒ– Ultralytics åŒ…ï¼Œå®šä¹‰åŒ…çš„å…¬å…±æ¥å£ã€‚                  |
| `ultralytics/utils/errors.py`            | å®šä¹‰é¡¹ç›®ä¸­ä½¿ç”¨çš„è‡ªå®šä¹‰é”™è¯¯å’Œå¼‚å¸¸å¤„ç†ç±»ã€‚                  |
| `ultralytics/solutions/ai_gym.py`       | æä¾›ä¸ AI Gym ç›¸å…³çš„è§£å†³æ–¹æ¡ˆå’Œæ¥å£ï¼ˆå‡è®¾çš„æ–‡ä»¶ï¼‰ã€‚         |
| `ultralytics/models/yolo/pose/predict.py`| å®ç° YOLO å§¿æ€ä¼°è®¡æ¨¡å‹çš„æ¨ç†é€»è¾‘ï¼ˆå‡è®¾çš„æ–‡ä»¶ï¼‰ã€‚           |

> æ³¨ï¼šéƒ¨åˆ†æ–‡ä»¶çš„åŠŸèƒ½æè¿°åŸºäºå‡è®¾ï¼Œå…·ä½“åŠŸèƒ½å¯èƒ½éœ€è¦æ ¹æ®å®é™…ä»£ç å†…å®¹è¿›è¡Œç¡®è®¤ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/ZpqcmZpt](https://mbd.pub/o/bread/ZpqcmZpt)